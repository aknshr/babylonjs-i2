{"version":3,"file":"6894.bundle.js","mappings":"kSA+DA,MAAMA,GAAY,SAAW,CACzBC,gBAAiB,CAAC,EAClBC,wBAAyB,CACrBC,OAAQ,OACRC,MAAO,OACPC,SAAU,QACVC,UAAW,OACXC,gBAAiB,MAAOC,yBAE5BC,oBAAqB,CACjBJ,SAAU,OACVC,UAAW,QAEfI,uBAAwB,CACpBC,WAAY,aAAa,MAAOC,sBAChCC,YAAa,aAAa,MAAOC,uBAErCC,gBAAiB,CAAC,EAClBC,cAAe,CAAC,EAChBC,qBAAsB,CAClBC,QAAS,GAAG,MAAOC,oBAAoB,MAAOP,qBAC9CQ,QAAS,OACTC,cAAe,SACfC,OAAQ,MAAOC,kBAEnBC,eAAgB,CACZJ,QAAS,OACTK,WAAY,SACZC,UAAW,MAAOd,oBAEtBe,qBAAsB,CAClBP,QAAS,OACTC,cAAe,MACfK,UAAW,MAAOZ,oBAEtBc,yBAA0B,CACtBjB,WAAY,OACZkB,UAAW,cAEfC,QAAS,CACLC,kBAAmB,KACnBC,cAAe,CACXC,KAAM,CAAEC,QAAS,GACjBC,GAAI,CAAED,QAAS,KAGvBE,eAAgB,CACZhB,QAAS,OACTC,cAAe,UAEnBgB,gBAAiB,CACbjB,QAAS,OACTC,cAAe,MACfK,UAAW,MAAOZ,mBAClBW,WAAY,UAEhBa,wBAAyB,CACrBlB,QAAS,OACTC,cAAe,SACfC,OAAQ,MAAOiB,kBAEnBC,mBAAoB,CAChBpB,QAAS,OACTC,cAAe,MACfK,UAAW,MAAOZ,mBAClBW,WAAY,UAEhBgB,mBAAoB,CAChBrB,QAAS,OACTC,cAAe,SACfC,OAAQ,MAAOiB,kBAEnBG,iBAAkB,CACdtB,QAAS,OACTC,cAAe,MACfK,UAAW,MAAOiB,qBAEtBC,gBAAiB,CACbC,OAAQ,aAIhB,SAASC,EAAiBC,GACtB,MAAsB,iBAAXA,EACA,CAAEC,KAAMD,GAEZA,CACX,CAEA,SAASE,EAAkBC,GACvB,MAAMC,GAAgB,IAAAC,UAAQ,IAAOF,EAASA,EAAOG,QAAQN,KAAgDA,IAAU,IAAK,CAACG,KAGtHI,IAAoB,IAAAC,UAASJ,EAAcK,IAAIV,IAyBtD,OAAOQ,EAAiBD,OAAOI,QACnC,CAEA,MAAMC,GAAoB,QAA0B,cAE9CC,EAA0GC,IAC5G,MAAM,IAAEC,EAAG,WAAEC,EAAU,KAAEC,EAAI,MAAEC,GAAUJ,EACnCK,EAAUjE,IAEhB,OACI,gBAAKkE,UAAWD,EAAQ7B,eAAc,UAClC,SAAC,MAAO,CAAC+B,QAASH,EAAOI,aAAa,QAAQC,YAAY,SAASC,WAAS,YACxE,iBAAKJ,UAAWD,EAAQ5B,gBAAe,UAClC0B,GACD,SAAC,IAAI,CAACF,IAAKA,EAAKU,MAAOT,GAAcD,YAOnDW,EAAyHZ,IAC3H,MAAM,OAAEb,EAAM,MAAE0B,EAAK,SAAEC,EAAQ,SAAEC,GAAaf,EACxCK,EAAUjE,IAEhB,OAAI0E,GACO,8BAAGC,KAIV,UAAC,MAAO,CAACL,WAAS,aACd,SAAC,MAAc,CAACM,0BAAwB,WAAED,KAC1C,SAAC,MAAc,WACX,iBAAKT,UAAWD,EAAQ3B,wBAAuB,WAC3C,SAAC,MAAO,CAACU,KAAMD,EAAOC,KAAM6B,cAAeJ,IAC1C1B,EAAO+B,QAAS,SAACnB,EAAW,CAACE,IAAK,UAAUd,EAAO+B,QAAShB,WAAYf,EAAO+B,MAAOf,MAAM,SAAC,OAAW,IAAKC,MAAM,UACnHjB,EAAOc,MAAO,SAACF,EAAW,CAACE,IAAKd,EAAOc,IAAKC,WAAYf,EAAOc,IAAKE,MAAM,SAAC,OAAW,IAAKC,MAAM,YACjGjB,EAAOgC,gBACJ,SAACpB,EAAW,CACRE,IAAK,iCAAiCd,EAAOgC,gBAC7CjB,WAAYf,EAAOgC,cACnBhB,MAAM,SAAC,OAAsB,IAC7BC,MAAM,mBAS5BgB,GAAiE,IAAAC,OAAMrB,IACzE,MAAM,UAAEsB,GAActB,GAChB,SAAEuB,GAAaD,EAEfjB,EAAUjE,KAEToF,EAAYC,IAAiB,IAAA9B,WAAS,IACtC+B,EAAcC,IAAmB,IAAAhC,WAAS,IAC1CiC,EAAiBC,IAAsB,IAAAlC,WAAS,IAEvD,IAAAmC,YAAU,KACN,MAAMC,EAAc,KAChBN,GAAeH,EAAUU,cAAgBV,EAAUM,iBACnDD,EAAgBL,EAAUU,cAAgBV,EAAUM,iBACpDC,EAAmBP,EAAUM,kBAG3BK,EAAkCX,EAAUY,uBAAuBH,GAGzE,OAFAA,IAEOE,EAAgCE,UACxC,CAACb,IAEJ,MAAOc,GAAU/C,GAAkB,IAAAG,UAAQ,IAAM,CAAC+B,EAASa,SAAS,CAACb,EAASa,UACxEC,EAAehD,EAAkBkC,EAASc,cAE1CC,EAAqBf,EAASgB,UAAYhB,EAASiB,YAAcjB,EAASkB,KAC1EC,EAAmBN,GAAUC,EAAaM,OAAS,EACnDC,EAAoBN,GAAsBI,EAC1CG,EAAmBT,GAAQlB,OAASkB,GAAQnC,KAAOmC,GAAQjB,cAC3D2B,EAAY,CAACvB,EAASwB,QAAU,GAAGxB,EAASwB,UAAY,KAAMxB,EAASyB,QAAU,GAAGzB,EAASyB,UAAY,MAAMvD,OAAOI,SAASoD,KAAK,OAEpIC,GAAU,IAAAC,cAAYC,UACxB,UACU9B,EAAU+B,cACpB,CAAE,MAEF,IACD,CAAC/B,IAEEgC,GAAY,IAAAH,cAAYC,UAC1B,UACU9B,EAAUiC,gBACpB,CAAE,MAEF,IACD,CAACjC,IAEJ,OACI,UAAC,MAAa,CAAChB,UAAWD,EAAQjD,cAAeuD,MAAOW,EAAUC,SAASnC,KAAI,WAC3E,SAAC,MAAe,CAACkB,UAAWD,EAAQlD,gBAAiBqG,mBAAmB,MAAK,UACzE,iBAAKlD,UAAWD,EAAQzB,mBAAkB,WACtC,SAAC,MAAW,UAAE0C,EAAUC,SAASnC,QACjC,SAAC,KAAI,CAACqE,QAASnC,EAAUU,YAAW,UAChC,SAAC,MAAa,CAAC0B,KAAK,kBAIhC,SAAC,MAAc,WACX,UAAC,MAAI,YACD,SAAC,MAAU,CAACC,QAAQ,SAAC,MAAK,UAAEpC,EAASqC,cAAsBA,aAAa,SAAC,MAAQ,CAACC,QAAM,WAAEf,MACzFF,IACG,UAAC,MAAW,CAACtC,UAAWD,EAAQhD,qBAAoB,UAC/CiF,IACG,iBAAKhC,UAAWD,EAAQxB,mBAAoBiF,MAAO,CAAEtG,QAAS,QAAQ,UACjE+D,EAASgB,WAAY,SAACxC,EAAW,CAACE,IAAKsB,EAASgB,SAAUpC,MAAM,SAAC,OAAW,IAAKC,MAAM,YACvFmB,EAASiB,aAAc,SAACzC,EAAW,CAACE,IAAKsB,EAASiB,WAAYrC,MAAM,SAAC,OAAiB,IAAKC,MAAM,eACjGmB,EAASkB,OAAQ,SAAC1C,EAAW,CAACE,IAAKsB,EAASkB,KAAMtC,MAAM,SAAC,OAAU,IAAKC,MAAM,qBAGtFsC,IACG,iBAAKpC,UAAWD,EAAQvB,iBAAkBgF,MAAO,CAAEtG,QAAS,QAAQ,UAC/D4E,IACG,SAACxB,EAAoB,CAACzB,OAAQiD,EAAQvB,MAAM,SAASC,UAAW+B,EAAgB,UAC5E,SAAC,MAAO,CAACzD,KAAMgD,EAAOhD,KAAM6B,cAAc,SAAS6C,MAAO,CAAE7E,OAAQ4D,EAAmB,UAAY,eAG1GR,EAAaM,OAAS,IACnB,SAAC,MAAW,CAACoB,OAAO,QAAO,SACtB1B,EAAazC,KAAKoE,IAEX,SAACpD,EAAoB,CAAwBzB,OAAQ6E,EAAanD,MAAM,cAAa,UACjF,SAAC,MAAe,CAACzB,KAAM4E,EAAY5E,KAAMkB,UAAWD,EAAQrB,mBADrCgF,EAAY5E,iBAWvE,UAAC,MAAU,WACNoC,IACG,SAAC,MAAM,CAACyC,WAAW,UAAUP,KAAK,QAAQvD,MAAM,SAAC,OAAoB,IAAK+D,QAAShB,EAAO,iBAI7FxB,IACG,SAAC,MAAM,CAACuC,WAAW,YAAYP,KAAK,QAAQvD,MAAM,SAAC,OAAa,IAAK+D,QAASZ,EAAS,oBAI1F1B,IAAmB,SAAC,MAAO,CAACtB,UAAWD,EAAQnC,QAASwF,KAAK,8BAUzES,EAAyE,CAClFC,aAAc,gBACdC,SAAU,CAAC,MACXC,QAAUC,IACN,MAAMC,EAAeD,EAAaE,eAAe,CAC7CC,IAAK,gBACLC,mBAAoB,QACpBC,iBAAkB,MAClBC,wBAAwB,EACxBC,OAAQ,IACRC,UAAW,KACP,MAAM1E,EAAUjE,KAET4I,EAAaC,IAAkB,IAAAtF,UAAmB,aACnDuF,GAAmB,UAClBC,EAAYC,IAAiB,IAAAzF,UAAuB,KAE3D,IAAAmC,YAAU,KACN,GAAIoD,EAAkB,CAClB,MAAMG,EAA0BjC,UAC5B,MAAMkC,QAAcJ,EAAiBK,0BAAqBC,OAAWA,EAA2B,cAAhBR,GAC1EG,QAAmBG,EAAMG,mBAAmB,EAAGH,EAAMI,YAC3DN,EAAcD,IAIlBE,IAA0BM,OAAOC,IAC7B,IAAOC,KAAK,kCAAkCD,OAEtD,IACD,CAACV,EAAkBF,IAEtB,MAAMc,EAAiBhG,IAEvB,OACI,iCACI,SAAC,IAAc,IACPgG,EACJjF,MAAM,aACN+C,YAAY,4IAEhB,UAAC,MAAM,YACH,SAAC,MAAa,CAAC5C,0BAAwB,YACnC,SAAC,MAAO,CAACT,QAAQ,oBAAoBC,aAAa,QAAO,UACrD,SAAC,MAAM,CAACuF,IAAKD,EAAeE,UAAW1F,UAAWD,EAAQhE,gBAAiB4H,WAAW,SAAS9D,MAAM,SAAC,OAAgB,WAG9H,SAAC,MAAa,CAACG,UAAWD,EAAQ/D,wBAAuB,UACrD,UAAC,MAAU,CAACgE,UAAWD,EAAQxD,oBAAmB,WAC9C,SAAC,MAAW,CACRoJ,QACI,SAAC,MAAa,CAACA,OAAO,QAAO,UACzB,SAAC,MAAM,CAAChC,WAAW,SAAQ,aAAY,QAAQ9D,MAAM,SAAC,OAAc,QACxD,UAGpB,8CAEI,UAAC,MAAO,CACJG,UAAWD,EAAQvD,uBACnBoJ,cAAelB,EACfmB,YAAa,CAACC,EAAuBC,KACjCpB,EAAeoB,EAAK1F,QACvB,WAED,SAAC,MAAG,CAACA,MAAO,YAA8B,wBAC1C,SAAC,MAAG,CAACA,MAAO,YAA8B,gCAItD,SAAC,MAAa,CAACL,UAAWD,EAAQvD,uBAAsB,UACpD,SAAC,MAAS,CAACwJ,aAAW,WACjBnB,EAAWvF,KAAK0B,IACb,SAACF,EAAgB,CAA+BE,UAAWA,GAApCA,EAAUC,SAASnC,0BAYlF,MAAO,CACH+C,QAAS,IAAMqC,EAAarC,Y","sources":["webpack://@dev/inspector-v2/./src/services/extensionsListService.tsx?"],"sourcesContent":["import type { SelectTabData, SelectTabEvent } from \"@fluentui/react-components\";\r\nimport type { TriggerProps } from \"@fluentui/react-utilities\";\r\nimport type { FunctionComponent } from \"react\";\r\nimport type { PersonMetadata } from \"../extensibility/extensionFeed\";\r\nimport type { IExtension } from \"../extensibility/extensionManager\";\r\nimport type { ServiceDefinition } from \"../modularity/serviceDefinition\";\r\nimport type { IShellService } from \"./shellService\";\r\n\r\nimport {\r\n    Accordion,\r\n    AccordionHeader,\r\n    AccordionItem,\r\n    AccordionPanel,\r\n    AvatarGroup,\r\n    AvatarGroupItem,\r\n    Body1,\r\n    Body1Strong,\r\n    Button,\r\n    Caption1,\r\n    Card,\r\n    CardFooter,\r\n    CardHeader,\r\n    CardPreview,\r\n    Dialog,\r\n    DialogBody,\r\n    DialogContent,\r\n    DialogSurface,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n    makeStyles,\r\n    Persona,\r\n    Popover,\r\n    PopoverSurface,\r\n    PopoverTrigger,\r\n    PresenceBadge,\r\n    Spinner,\r\n    Tab,\r\n    TabList,\r\n    tokens,\r\n    Tooltip,\r\n} from \"@fluentui/react-components\";\r\nimport {\r\n    AppsAddInRegular,\r\n    ArrowDownloadRegular,\r\n    BranchForkRegular,\r\n    BugRegular,\r\n    DeleteRegular,\r\n    DismissRegular,\r\n    LinkRegular,\r\n    MailRegular,\r\n    PeopleCommunityRegular,\r\n} from \"@fluentui/react-icons\";\r\nimport { Fade } from \"@fluentui/react-motion-components-preview\";\r\nimport { memo, useCallback, useEffect, useMemo, useState } from \"react\";\r\n\r\nimport { Logger } from \"core/Misc/logger\";\r\n\r\nimport { Link } from \"shared-ui-components/fluent/primitives/link\";\r\nimport { TeachingMoment } from \"../components/teachingMoment\";\r\nimport { useExtensionManager } from \"../contexts/extensionManagerContext\";\r\nimport { MakePopoverTeachingMoment } from \"../hooks/teachingMomentHooks\";\r\nimport { ShellServiceIdentity } from \"./shellService\";\r\n\r\nconst useStyles = makeStyles({\r\n    extensionButton: {},\r\n    extensionsDialogSurface: {\r\n        height: \"auto\",\r\n        width: \"70vw\",\r\n        maxWidth: \"600px\",\r\n        maxHeight: \"70vh\",\r\n        backgroundColor: tokens.colorNeutralBackground2,\r\n    },\r\n    extensionDialogBody: {\r\n        maxWidth: \"100%\",\r\n        maxHeight: \"100%\",\r\n    },\r\n    extensionDialogContent: {\r\n        marginLeft: `calc(-1 * ${tokens.spacingHorizontalM})`,\r\n        marginRight: `calc(-1 * ${tokens.spacingHorizontalS})`,\r\n    },\r\n    extensionHeader: {},\r\n    extensionItem: {},\r\n    extensionCardPreview: {\r\n        padding: `${tokens.spacingVerticalM} ${tokens.spacingHorizontalM}`,\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        rowGap: tokens.spacingVerticalL,\r\n    },\r\n    extensionIntro: {\r\n        display: \"flex\",\r\n        alignItems: \"center\",\r\n        columnGap: tokens.spacingHorizontalM,\r\n    },\r\n    extensionDescription: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        columnGap: tokens.spacingHorizontalS,\r\n    },\r\n    extensionButtonContainer: {\r\n        marginLeft: \"auto\",\r\n        alignSelf: \"flex-start\",\r\n    },\r\n    spinner: {\r\n        animationDuration: \"1s\",\r\n        animationName: {\r\n            from: { opacity: 0 },\r\n            to: { opacity: 1 },\r\n        },\r\n    },\r\n    webResourceDiv: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n    },\r\n    webResourceLink: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        columnGap: tokens.spacingHorizontalS,\r\n        alignItems: \"center\",\r\n    },\r\n    personPopoverSurfaceDiv: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        rowGap: tokens.spacingVerticalS,\r\n    },\r\n    accordionHeaderDiv: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        columnGap: tokens.spacingHorizontalS,\r\n        alignItems: \"center\",\r\n    },\r\n    resourceDetailsDiv: {\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        rowGap: tokens.spacingVerticalS,\r\n    },\r\n    peopleDetailsDiv: {\r\n        display: \"flex\",\r\n        flexDirection: \"row\",\r\n        columnGap: tokens.spacingHorizontalXL,\r\n    },\r\n    avatarGroupItem: {\r\n        cursor: \"pointer\",\r\n    },\r\n});\r\n\r\nfunction AsPersonMetadata(person: string | PersonMetadata): PersonMetadata {\r\n    if (typeof person === \"string\") {\r\n        return { name: person } satisfies PersonMetadata;\r\n    }\r\n    return person;\r\n}\r\n\r\nfunction usePeopleMetadata(people?: readonly (string | PersonMetadata | undefined)[]) {\r\n    const definedPeople = useMemo(() => (people ? people.filter((person): person is string | PersonMetadata => !!person) : []), [people]);\r\n\r\n    //const [peopleMetadataEx, setPeopleMetadataEx] = useState<(PersonMetadata & { avatarUrl?: string })[]>(definedPeople.map(AsPersonMetadata));\r\n    const [peopleMetadataEx] = useState(definedPeople.map(AsPersonMetadata));\r\n\r\n    // TODO: Would be nice if we could pull author/contributor profile pictures from the forum, but need to see if this is ok and whether we want to adjust CORS to allow it.\r\n    // useEffect(() => {\r\n    //     definedPeople.forEach(async (person, index) => {\r\n    //         const personMetadata = AsPersonMetadata(person);\r\n    //         if (personMetadata.forumUserName) {\r\n    //             try {\r\n    //                 const json = await (await fetch(`https://forum.babylonjs.com/u/${personMetadata.forumUserName}.json`)).json();\r\n    //                 const avatarRelativeUrl = json.user?.avatar_template?.replace(\"{size}\", \"96\");\r\n    //                 if (avatarRelativeUrl) {\r\n    //                     const avatarUrl = `https://forum.babylonjs.com${avatarRelativeUrl}`;\r\n    //                     setPeopleMetadataEx((prev) => {\r\n    //                         const newMetadata = [...prev];\r\n    //                         newMetadata[index] = { ...personMetadata, avatarUrl };\r\n    //                         return newMetadata;\r\n    //                     });\r\n    //                 }\r\n    //             } catch {\r\n    //                 // Ignore, non-fatal\r\n    //             }\r\n    //         }\r\n    //     });\r\n    // }, [definedPeople]);\r\n\r\n    return peopleMetadataEx.filter(Boolean);\r\n}\r\n\r\nconst useTeachingMoment = MakePopoverTeachingMoment(\"Extensions\");\r\n\r\nconst WebResource: FunctionComponent<{ url: string; urlDisplay?: string; icon: JSX.Element; label: string }> = (props) => {\r\n    const { url, urlDisplay, icon, label } = props;\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <div className={classes.webResourceDiv}>\r\n            <Tooltip content={label} relationship=\"label\" positioning=\"before\" withArrow>\r\n                <div className={classes.webResourceLink}>\r\n                    {icon}\r\n                    <Link url={url} value={urlDisplay || url} />\r\n                </div>\r\n            </Tooltip>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst PersonDetailsPopover: FunctionComponent<TriggerProps & { person: PersonMetadata; title: string; disabled?: boolean }> = (props) => {\r\n    const { person, title, disabled, children } = props;\r\n    const classes = useStyles();\r\n\r\n    if (disabled) {\r\n        return <>{children}</>;\r\n    }\r\n\r\n    return (\r\n        <Popover withArrow>\r\n            <PopoverTrigger disableButtonEnhancement>{children}</PopoverTrigger>\r\n            <PopoverSurface>\r\n                <div className={classes.personPopoverSurfaceDiv}>\r\n                    <Persona name={person.name} secondaryText={title} />\r\n                    {person.email && <WebResource url={`mailto:${person.email}`} urlDisplay={person.email} icon={<MailRegular />} label=\"Email\" />}\r\n                    {person.url && <WebResource url={person.url} urlDisplay={person.url} icon={<LinkRegular />} label=\"Website\" />}\r\n                    {person.forumUserName && (\r\n                        <WebResource\r\n                            url={`https://forum.babylonjs.com/u/${person.forumUserName}`}\r\n                            urlDisplay={person.forumUserName}\r\n                            icon={<PeopleCommunityRegular />}\r\n                            label=\"Forum\"\r\n                        />\r\n                    )}\r\n                </div>\r\n            </PopoverSurface>\r\n        </Popover>\r\n    );\r\n};\r\n\r\nconst ExtensionDetails: FunctionComponent<{ extension: IExtension }> = memo((props) => {\r\n    const { extension } = props;\r\n    const { metadata } = extension;\r\n\r\n    const classes = useStyles();\r\n\r\n    const [canInstall, setCanInstall] = useState(false);\r\n    const [canUninstall, setCanUninstall] = useState(false);\r\n    const [isStateChanging, setIsStateChanging] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const updateState = () => {\r\n            setCanInstall(!extension.isInstalled && !extension.isStateChanging);\r\n            setCanUninstall(extension.isInstalled && !extension.isStateChanging);\r\n            setIsStateChanging(extension.isStateChanging);\r\n        };\r\n\r\n        const stateChangedHandlerRegistration = extension.addStateChangedHandler(updateState);\r\n        updateState();\r\n\r\n        return stateChangedHandlerRegistration.dispose;\r\n    }, [extension]);\r\n\r\n    const [author] = usePeopleMetadata(useMemo(() => [metadata.author], [metadata.author]));\r\n    const contributors = usePeopleMetadata(metadata.contributors);\r\n\r\n    const hasResourceDetails = metadata.homepage || metadata.repository || metadata.bugs;\r\n    const hasPeopleDetails = author || contributors.length > 0;\r\n    const hasPreviewDetails = hasResourceDetails || hasPeopleDetails;\r\n    const hasAuthorDetails = author?.email || author?.url || author?.forumUserName;\r\n    const subHeader = [metadata.version ? `${metadata.version}` : null, metadata.license ? `${metadata.license}` : null].filter(Boolean).join(\" | \");\r\n\r\n    const install = useCallback(async () => {\r\n        try {\r\n            await extension.installAsync();\r\n        } catch {\r\n            // Ignore errors. Other parts of the infrastructure handle them and communicate them to the user.\r\n        }\r\n    }, [extension]);\r\n\r\n    const uninstall = useCallback(async () => {\r\n        try {\r\n            await extension.uninstallAsync();\r\n        } catch {\r\n            // Ignore errors. Other parts of the infrastructure handle them and communicate them to the user.\r\n        }\r\n    }, [extension]);\r\n\r\n    return (\r\n        <AccordionItem className={classes.extensionItem} value={extension.metadata.name}>\r\n            <AccordionHeader className={classes.extensionHeader} expandIconPosition=\"end\">\r\n                <div className={classes.accordionHeaderDiv}>\r\n                    <Body1Strong>{extension.metadata.name}</Body1Strong>\r\n                    <Fade visible={extension.isInstalled}>\r\n                        <PresenceBadge size=\"small\" />\r\n                    </Fade>\r\n                </div>\r\n            </AccordionHeader>\r\n            <AccordionPanel>\r\n                <Card>\r\n                    <CardHeader header={<Body1>{metadata.description}</Body1>} description={<Caption1 italic>{subHeader}</Caption1>} />\r\n                    {hasPreviewDetails && (\r\n                        <CardPreview className={classes.extensionCardPreview}>\r\n                            {hasResourceDetails && (\r\n                                <div className={classes.resourceDetailsDiv} style={{ display: \"flex\" }}>\r\n                                    {metadata.homepage && <WebResource url={metadata.homepage} icon={<LinkRegular />} label=\"Website\" />}\r\n                                    {metadata.repository && <WebResource url={metadata.repository} icon={<BranchForkRegular />} label=\"Repository\" />}\r\n                                    {metadata.bugs && <WebResource url={metadata.bugs} icon={<BugRegular />} label=\"Report Issues\" />}\r\n                                </div>\r\n                            )}\r\n                            {hasPeopleDetails && (\r\n                                <div className={classes.peopleDetailsDiv} style={{ display: \"flex\" }}>\r\n                                    {author && (\r\n                                        <PersonDetailsPopover person={author} title=\"Author\" disabled={!hasAuthorDetails}>\r\n                                            <Persona name={author.name} secondaryText=\"Author\" style={{ cursor: hasAuthorDetails ? \"pointer\" : \"default\" }} />\r\n                                        </PersonDetailsPopover>\r\n                                    )}\r\n                                    {contributors.length > 0 && (\r\n                                        <AvatarGroup layout=\"stack\">\r\n                                            {contributors.map((contributor) => {\r\n                                                return (\r\n                                                    <PersonDetailsPopover key={contributor.name} person={contributor} title=\"Contributor\">\r\n                                                        <AvatarGroupItem name={contributor.name} className={classes.avatarGroupItem} />\r\n                                                    </PersonDetailsPopover>\r\n                                                );\r\n                                            })}\r\n                                        </AvatarGroup>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </CardPreview>\r\n                    )}\r\n                    <CardFooter>\r\n                        {canInstall && (\r\n                            <Button appearance=\"primary\" size=\"small\" icon={<ArrowDownloadRegular />} onClick={install}>\r\n                                Get\r\n                            </Button>\r\n                        )}\r\n                        {canUninstall && (\r\n                            <Button appearance=\"secondary\" size=\"small\" icon={<DeleteRegular />} onClick={uninstall}>\r\n                                Remove\r\n                            </Button>\r\n                        )}\r\n                        {isStateChanging && <Spinner className={classes.spinner} size=\"extra-small\" />}\r\n                    </CardFooter>\r\n                </Card>\r\n            </AccordionPanel>\r\n        </AccordionItem>\r\n    );\r\n});\r\n\r\ntype TabValue = \"available\" | \"installed\";\r\n\r\nexport const ExtensionListServiceDefinition: ServiceDefinition<[], [IShellService]> = {\r\n    friendlyName: \"ExtensionList\",\r\n    consumes: [ShellServiceIdentity],\r\n    factory: (shellService) => {\r\n        const registration = shellService.addToolbarItem({\r\n            key: \"ExtensionList\",\r\n            horizontalLocation: \"right\",\r\n            verticalLocation: \"top\",\r\n            suppressTeachingMoment: true,\r\n            order: -200,\r\n            component: () => {\r\n                const classes = useStyles();\r\n\r\n                const [selectedTab, setSelectedTab] = useState<TabValue>(\"available\");\r\n                const extensionManager = useExtensionManager();\r\n                const [extensions, setExtensions] = useState<IExtension[]>([]);\r\n\r\n                useEffect(() => {\r\n                    if (extensionManager) {\r\n                        const populateExtensionsAsync = async () => {\r\n                            const query = await extensionManager.queryExtensionsAsync(undefined, undefined, selectedTab === \"installed\");\r\n                            const extensions = await query.getExtensionsAsync(0, query.totalCount);\r\n                            setExtensions(extensions);\r\n                        };\r\n\r\n                        // eslint-disable-next-line github/no-then\r\n                        populateExtensionsAsync().catch((error) => {\r\n                            Logger.Warn(`Failed to populate extensions: ${error}`);\r\n                        });\r\n                    }\r\n                }, [extensionManager, selectedTab]);\r\n\r\n                const teachingMoment = useTeachingMoment();\r\n\r\n                return (\r\n                    <>\r\n                        <TeachingMoment\r\n                            {...teachingMoment}\r\n                            title=\"Extensions\"\r\n                            description=\"Extensions provide new optional features that can be useful to your specific task or workflow. Click this button to manage extensions.\"\r\n                        />\r\n                        <Dialog>\r\n                            <DialogTrigger disableButtonEnhancement>\r\n                                <Tooltip content=\"Manage Extensions\" relationship=\"label\">\r\n                                    <Button ref={teachingMoment.targetRef} className={classes.extensionButton} appearance=\"subtle\" icon={<AppsAddInRegular />} />\r\n                                </Tooltip>\r\n                            </DialogTrigger>\r\n                            <DialogSurface className={classes.extensionsDialogSurface}>\r\n                                <DialogBody className={classes.extensionDialogBody}>\r\n                                    <DialogTitle\r\n                                        action={\r\n                                            <DialogTrigger action=\"close\">\r\n                                                <Button appearance=\"subtle\" aria-label=\"close\" icon={<DismissRegular />} />\r\n                                            </DialogTrigger>\r\n                                        }\r\n                                    >\r\n                                        <>\r\n                                            Extensions\r\n                                            <TabList\r\n                                                className={classes.extensionDialogContent}\r\n                                                selectedValue={selectedTab}\r\n                                                onTabSelect={(event: SelectTabEvent, data: SelectTabData) => {\r\n                                                    setSelectedTab(data.value as TabValue);\r\n                                                }}\r\n                                            >\r\n                                                <Tab value={\"available\" satisfies TabValue}>Available</Tab>\r\n                                                <Tab value={\"installed\" satisfies TabValue}>Installed</Tab>\r\n                                            </TabList>\r\n                                        </>\r\n                                    </DialogTitle>\r\n                                    <DialogContent className={classes.extensionDialogContent}>\r\n                                        <Accordion collapsible>\r\n                                            {extensions.map((extension) => (\r\n                                                <ExtensionDetails key={extension.metadata.name} extension={extension} />\r\n                                            ))}\r\n                                        </Accordion>\r\n                                    </DialogContent>\r\n                                </DialogBody>\r\n                            </DialogSurface>\r\n                        </Dialog>\r\n                    </>\r\n                );\r\n            },\r\n        });\r\n\r\n        return {\r\n            dispose: () => registration.dispose(),\r\n        };\r\n    },\r\n};\r\n"],"names":["useStyles","extensionButton","extensionsDialogSurface","height","width","maxWidth","maxHeight","backgroundColor","colorNeutralBackground2","extensionDialogBody","extensionDialogContent","marginLeft","spacingHorizontalM","marginRight","spacingHorizontalS","extensionHeader","extensionItem","extensionCardPreview","padding","spacingVerticalM","display","flexDirection","rowGap","spacingVerticalL","extensionIntro","alignItems","columnGap","extensionDescription","extensionButtonContainer","alignSelf","spinner","animationDuration","animationName","from","opacity","to","webResourceDiv","webResourceLink","personPopoverSurfaceDiv","spacingVerticalS","accordionHeaderDiv","resourceDetailsDiv","peopleDetailsDiv","spacingHorizontalXL","avatarGroupItem","cursor","AsPersonMetadata","person","name","usePeopleMetadata","people","definedPeople","useMemo","filter","peopleMetadataEx","useState","map","Boolean","useTeachingMoment","WebResource","props","url","urlDisplay","icon","label","classes","className","content","relationship","positioning","withArrow","value","PersonDetailsPopover","title","disabled","children","disableButtonEnhancement","secondaryText","email","forumUserName","ExtensionDetails","memo","extension","metadata","canInstall","setCanInstall","canUninstall","setCanUninstall","isStateChanging","setIsStateChanging","useEffect","updateState","isInstalled","stateChangedHandlerRegistration","addStateChangedHandler","dispose","author","contributors","hasResourceDetails","homepage","repository","bugs","hasPeopleDetails","length","hasPreviewDetails","hasAuthorDetails","subHeader","version","license","join","install","useCallback","async","installAsync","uninstall","uninstallAsync","expandIconPosition","visible","size","header","description","italic","style","layout","contributor","appearance","onClick","ExtensionListServiceDefinition","friendlyName","consumes","factory","shellService","registration","addToolbarItem","key","horizontalLocation","verticalLocation","suppressTeachingMoment","order","component","selectedTab","setSelectedTab","extensionManager","extensions","setExtensions","populateExtensionsAsync","query","queryExtensionsAsync","undefined","getExtensionsAsync","totalCount","catch","error","Warn","teachingMoment","ref","targetRef","action","selectedValue","onTabSelect","event","data","collapsible"],"ignoreList":[],"sourceRoot":""}