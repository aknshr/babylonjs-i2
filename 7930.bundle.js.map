{"version":3,"file":"7930.bundle.js","mappings":"qOAaO,MAAMA,UAAiD,IAsB1D,WAAAC,CAAYC,GACRC,MAAMD,GAENE,KAAKC,aAAeD,KAAKE,kBAAkB,eAAgB,MAC3DF,KAAKG,kBAAoBH,KAAKE,kBAAkB,oBAAqB,MACrEF,KAAKI,iBAAmBJ,KAAKE,kBAAkB,mBAAoB,MACnEF,KAAKK,kBAAoBL,KAAKM,mBAAmB,oBAAqB,KAC1E,CAEgB,cAAAC,CAAeC,GAC3B,MAAMC,EAAoBT,KAAKC,aAAaS,SAASF,GAC/CG,EAAyBX,KAAKG,kBAAkBO,SAASF,GACzDI,EAAwBZ,KAAKI,iBAAiBM,SAASF,GAGvDK,EAAcJ,EAAkBK,iBAEhCC,EAAmBJ,EAAuBG,iBAC1CE,EAA0B,KAAWC,OAAO,GAAGC,SAASH,GAE9DC,EAAwBG,SAExB,MAAMC,EAAsB,KAAWH,OAAO,GAE9CD,EAAwBK,cAAcR,EAAaO,GACnD,MAAME,EAAyBtB,KAAKK,kBAAkBK,SAASF,GAE/D,KAAQe,0BAA0BX,EAAuBQ,EAAqBE,EAClF,CAMgB,YAAAE,GACZ,MAAO,0CACX,GAEJ,QAAc,2CAAgD5B,E","sources":["webpack://@dev/inspector-v2/../core/src/FlowGraph/Blocks/Data/flowGraphTransformCoordinatesSystemBlock.ts?"],"sourcesContent":["import { FlowGraphBlock } from \"../../flowGraphBlock\";\r\nimport type { FlowGraphContext } from \"../../flowGraphContext\";\r\nimport type { FlowGraphDataConnection } from \"../../flowGraphDataConnection\";\r\nimport { RichTypeAny, RichTypeVector3 } from \"../../flowGraphRichTypes\";\r\nimport { TmpVectors, Vector3 } from \"../../../Maths/math.vector\";\r\nimport type { TransformNode } from \"../../../Meshes/transformNode\";\r\nimport type { IFlowGraphBlockConfiguration } from \"../../flowGraphBlock\";\r\nimport { RegisterClass } from \"../../../Misc/typeStore\";\r\nimport { FlowGraphBlockNames } from \"../flowGraphBlockNames\";\r\n\r\n/**\r\n * This blocks transforms a vector from one coordinate system to another.\r\n */\r\nexport class FlowGraphTransformCoordinatesSystemBlock extends FlowGraphBlock {\r\n    /**\r\n     * Input connection: The source coordinate system.\r\n     */\r\n    public readonly sourceSystem: FlowGraphDataConnection<TransformNode>;\r\n    /**\r\n     * Input connection: The destination coordinate system.\r\n     */\r\n    public readonly destinationSystem: FlowGraphDataConnection<TransformNode>;\r\n    /**\r\n     * Input connection: The coordinates to transform.\r\n     */\r\n    public readonly inputCoordinates: FlowGraphDataConnection<Vector3>;\r\n    /**\r\n     * Output connection: The transformed coordinates.\r\n     */\r\n    public readonly outputCoordinates: FlowGraphDataConnection<Vector3>;\r\n\r\n    /**\r\n     * Creates a new FlowGraphCoordinateTransformBlock\r\n     * @param config optional configuration for this block\r\n     */\r\n    constructor(config?: IFlowGraphBlockConfiguration) {\r\n        super(config);\r\n\r\n        this.sourceSystem = this.registerDataInput(\"sourceSystem\", RichTypeAny);\r\n        this.destinationSystem = this.registerDataInput(\"destinationSystem\", RichTypeAny);\r\n        this.inputCoordinates = this.registerDataInput(\"inputCoordinates\", RichTypeVector3);\r\n        this.outputCoordinates = this.registerDataOutput(\"outputCoordinates\", RichTypeVector3);\r\n    }\r\n\r\n    public override _updateOutputs(_context: FlowGraphContext): void {\r\n        const sourceSystemValue = this.sourceSystem.getValue(_context);\r\n        const destinationSystemValue = this.destinationSystem.getValue(_context);\r\n        const inputCoordinatesValue = this.inputCoordinates.getValue(_context);\r\n\r\n        // takes coordinates from source space to world space\r\n        const sourceWorld = sourceSystemValue.getWorldMatrix();\r\n        // takes coordinates from destination space to world space\r\n        const destinationWorld = destinationSystemValue.getWorldMatrix();\r\n        const destinationWorldInverse = TmpVectors.Matrix[0].copyFrom(destinationWorld);\r\n        // takes coordinates from world space to destination space\r\n        destinationWorldInverse.invert();\r\n\r\n        const sourceToDestination = TmpVectors.Matrix[1];\r\n        // takes coordinates from source space to world space to destination space\r\n        destinationWorldInverse.multiplyToRef(sourceWorld, sourceToDestination);\r\n        const outputCoordinatesValue = this.outputCoordinates.getValue(_context);\r\n\r\n        Vector3.TransformCoordinatesToRef(inputCoordinatesValue, sourceToDestination, outputCoordinatesValue);\r\n    }\r\n\r\n    /**\r\n     * Gets the class name of this block\r\n     * @returns the class name\r\n     */\r\n    public override getClassName(): string {\r\n        return FlowGraphBlockNames.TransformCoordinatesSystem;\r\n    }\r\n}\r\nRegisterClass(FlowGraphBlockNames.TransformCoordinatesSystem, FlowGraphTransformCoordinatesSystemBlock);\r\n"],"names":["FlowGraphTransformCoordinatesSystemBlock","constructor","config","super","this","sourceSystem","registerDataInput","destinationSystem","inputCoordinates","outputCoordinates","registerDataOutput","_updateOutputs","_context","sourceSystemValue","getValue","destinationSystemValue","inputCoordinatesValue","sourceWorld","getWorldMatrix","destinationWorld","destinationWorldInverse","Matrix","copyFrom","invert","sourceToDestination","multiplyToRef","outputCoordinatesValue","TransformCoordinatesToRef","getClassName"],"ignoreList":[],"sourceRoot":""}