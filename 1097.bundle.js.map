{"version":3,"file":"1097.bundle.js","mappings":"iKAQA,MAAMA,EAAY,uBACZC,EAAkB,oBAKjB,MAAeC,UAA+C,IAWjE,WAAAC,CAAYC,EAAmCC,GAC3CC,MAAMD,GAENE,KAAKC,MAAQD,KAAKE,mBAAmB,QAASL,GAC9CG,KAAKG,QAAUH,KAAKE,mBAAmB,UAAW,KACtD,CASgB,cAAAE,CAAeC,GAC3B,MAAMC,EAAoBD,EAAQE,sBAAsBP,KAAMN,GAAkB,GAC1Ec,EAAcH,EAAQE,sBAAyCP,KAAMP,EAAW,MACtF,GAAIe,SAAqDF,IAAsBD,EAAQI,YACnFT,KAAKG,QAAQO,UAAS,EAAML,GAC5BL,KAAKC,MAAMS,SAASF,EAAaH,QAEjC,IACI,MAAMM,EAAkBX,KAAKY,aAAaP,GAC1C,GAAIM,QAEA,YADAX,KAAKG,QAAQO,UAAS,EAAOL,GAGjCA,EAAQQ,sBAAsBb,KAAMP,EAAWkB,GAC/CN,EAAQQ,sBAAsBb,KAAMN,EAAiBW,EAAQI,aAC7DT,KAAKC,MAAMS,SAASC,EAAiBN,GACrCL,KAAKG,QAAQO,UAAS,EAAML,EAChC,CAAE,MAAOS,GACLd,KAAKG,QAAQO,UAAS,EAAOL,EACjC,CAER,E,iDClDG,MAAMU,UAAsD,IAM/D,WAAAnB,CACIoB,EACAC,EACQC,EACAC,EACRrB,GAEAC,MAAMkB,EAAgBnB,GAJd,KAAAoB,WAAAA,EACA,KAAAC,WAAAA,EAIRnB,KAAKoB,EAAIpB,KAAKqB,kBAAkB,IAAKL,EACzC,CAOgB,YAAAJ,CAAaP,GACzB,OAAOL,KAAKkB,WAAWlB,KAAKoB,EAAEE,SAASjB,GAC3C,CAMgB,YAAAkB,GACZ,OAAOvB,KAAKmB,UAChB,E,0PChCG,MAAMK,UAAgC,IACzC,WAAA5B,CAAYE,GACRC,MAAM,KAAiB,MAAiBqB,IAAOA,GAAG,0BAAoCtB,EAC1F,GAGJ,QAAc,0BAAoC0B,GAK3C,MAAMC,UAA8B,IACvC,WAAA7B,CAAYE,GACRC,MAAM,KAAiB,MAA2BqB,GAAM,IAAiBM,WAAWN,IAAI,wBAAkCtB,EAC9H,GAGJ,QAAc,wBAAkC2B,GAKzC,MAAME,UAAgC,IACzC,WAAA/B,CAAYE,GACRC,MAAM,KAAgB,MAAkBqB,KAAQA,GAAG,0BAAoCtB,EAC3F,GAGJ,QAAc,0BAAoC6B,GAK3C,MAAMC,UAA8B,IACvC,WAAAhC,CAAYE,GACRC,MAAM,KAA0B,MAAkBqB,KAAQA,EAAEnB,OAAO,wBAAkCH,EACzG,GAGJ,QAAc,wBAAkC8B,GAKzC,MAAMC,UAA4B,IACrC,WAAAjC,CAAYE,GACRC,MAAM,KAA0B,MAAiBqB,GAAMA,EAAEnB,OAAO,sBAAgCH,EACpG,GAGJ,QAAc,sBAAgC+B,GAevC,MAAMC,UAA4B,IACrC,WAAAlC,CAAYE,GACRC,MACI,KACA,MACCqB,IACG,MAAMW,EAAejC,GAAQiC,aAC7B,OAAQA,GACJ,IAAK,QACD,OAAO,IAAiBL,UAAUM,KAAKC,MAAMb,IACjD,IAAK,OACD,OAAO,IAAiBM,UAAUM,KAAKE,KAAKd,IAChD,IAAK,QACD,OAAO,IAAiBM,UAAUM,KAAKG,MAAMf,IACjD,QACI,OAAO,IAAiBM,UAAUN,MAE7C,sBAEDtB,EAER,GAGJ,QAAc,sBAAgCgC,E","sources":["webpack://@dev/inspector-v2/../core/src/FlowGraph/Blocks/Data/flowGraphCachedOperationBlock.ts?","webpack://@dev/inspector-v2/../core/src/FlowGraph/Blocks/Data/flowGraphUnaryOperationBlock.ts?","webpack://@dev/inspector-v2/../core/src/FlowGraph/Blocks/Data/Transformers/flowGraphTypeToTypeBlocks.ts?"],"sourcesContent":["import type { Nullable } from \"../../../types\";\r\nimport type { IFlowGraphBlockConfiguration } from \"../../flowGraphBlock\";\r\nimport { FlowGraphBlock } from \"../../flowGraphBlock\";\r\nimport type { FlowGraphContext } from \"../../flowGraphContext\";\r\nimport type { FlowGraphDataConnection } from \"../../flowGraphDataConnection\";\r\nimport type { RichType } from \"../../flowGraphRichTypes\";\r\nimport { RichTypeBoolean } from \"../../flowGraphRichTypes\";\r\n\r\nconst CacheName = \"cachedOperationValue\";\r\nconst CacheExecIdName = \"cachedExecutionId\";\r\n\r\n/**\r\n * A block that will cache the result of an operation and deliver it as an output.\r\n */\r\nexport abstract class FlowGraphCachedOperationBlock<OutputT> extends FlowGraphBlock {\r\n    /**\r\n     * The output of the operation\r\n     */\r\n    public readonly value: FlowGraphDataConnection<OutputT>;\r\n\r\n    /**\r\n     * Output connection: Whether the value is valid.\r\n     */\r\n    public readonly isValid: FlowGraphDataConnection<boolean>;\r\n\r\n    constructor(outputRichType: RichType<OutputT>, config?: IFlowGraphBlockConfiguration) {\r\n        super(config);\r\n\r\n        this.value = this.registerDataOutput(\"value\", outputRichType);\r\n        this.isValid = this.registerDataOutput(\"isValid\", RichTypeBoolean);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     * Operation to realize\r\n     * @param context the graph context\r\n     */\r\n    public abstract _doOperation(context: FlowGraphContext): OutputT | undefined;\r\n\r\n    public override _updateOutputs(context: FlowGraphContext) {\r\n        const cachedExecutionId = context._getExecutionVariable(this, CacheExecIdName, -1);\r\n        const cachedValue = context._getExecutionVariable<Nullable<OutputT>>(this, CacheName, null);\r\n        if (cachedValue !== undefined && cachedValue !== null && cachedExecutionId === context.executionId) {\r\n            this.isValid.setValue(true, context);\r\n            this.value.setValue(cachedValue, context);\r\n        } else {\r\n            try {\r\n                const calculatedValue = this._doOperation(context);\r\n                if (calculatedValue === undefined || calculatedValue === null) {\r\n                    this.isValid.setValue(false, context);\r\n                    return;\r\n                }\r\n                context._setExecutionVariable(this, CacheName, calculatedValue);\r\n                context._setExecutionVariable(this, CacheExecIdName, context.executionId);\r\n                this.value.setValue(calculatedValue, context);\r\n                this.isValid.setValue(true, context);\r\n            } catch (e) {\r\n                this.isValid.setValue(false, context);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import type { FlowGraphDataConnection } from \"../../flowGraphDataConnection\";\r\nimport type { IFlowGraphBlockConfiguration } from \"../../flowGraphBlock\";\r\nimport type { RichType } from \"../../flowGraphRichTypes\";\r\nimport type { FlowGraphContext } from \"../../flowGraphContext\";\r\nimport { FlowGraphCachedOperationBlock } from \"./flowGraphCachedOperationBlock\";\r\n\r\n/**\r\n * @internal\r\n * The base block for all unary operation blocks. Receives an input of type InputT, and outputs a value of type ResultT.\r\n */\r\nexport class FlowGraphUnaryOperationBlock<InputT, ResultT> extends FlowGraphCachedOperationBlock<ResultT> {\r\n    /**\r\n     * the input of this block\r\n     */\r\n    a: FlowGraphDataConnection<InputT>;\r\n\r\n    constructor(\r\n        inputRichType: RichType<InputT>,\r\n        resultRichType: RichType<ResultT>,\r\n        private _operation: (input: InputT) => ResultT,\r\n        private _className: string,\r\n        config?: IFlowGraphBlockConfiguration\r\n    ) {\r\n        super(resultRichType, config);\r\n        this.a = this.registerDataInput(\"a\", inputRichType);\r\n    }\r\n\r\n    /**\r\n     * the operation performed by this block\r\n     * @param context the graph context\r\n     * @returns the result of the operation\r\n     */\r\n    public override _doOperation(context: FlowGraphContext): ResultT {\r\n        return this._operation(this.a.getValue(context));\r\n    }\r\n\r\n    /**\r\n     * Gets the class name of this block\r\n     * @returns the class name\r\n     */\r\n    public override getClassName(): string {\r\n        return this._className;\r\n    }\r\n}\r\n","import type { IFlowGraphBlockConfiguration } from \"core/FlowGraph/flowGraphBlock\";\nimport { FlowGraphUnaryOperationBlock } from \"../flowGraphUnaryOperationBlock\";\nimport { RichTypeBoolean, RichTypeFlowGraphInteger, RichTypeNumber } from \"core/FlowGraph/flowGraphRichTypes\";\nimport { FlowGraphBlockNames } from \"../../flowGraphBlockNames\";\nimport { RegisterClass } from \"core/Misc/typeStore\";\nimport { FlowGraphInteger } from \"core/FlowGraph/CustomTypes/flowGraphInteger\";\n\n/**\n * A block that converts a boolean to a float.\n */\nexport class FlowGraphBooleanToFloat extends FlowGraphUnaryOperationBlock<boolean, number> {\n    constructor(config?: IFlowGraphBlockConfiguration) {\n        super(RichTypeBoolean, RichTypeNumber, (a) => +a, FlowGraphBlockNames.BooleanToFloat, config);\n    }\n}\n\nRegisterClass(FlowGraphBlockNames.BooleanToFloat, FlowGraphBooleanToFloat);\n\n/**\n * A block that converts a boolean to an integer\n */\nexport class FlowGraphBooleanToInt extends FlowGraphUnaryOperationBlock<boolean, FlowGraphInteger> {\n    constructor(config?: IFlowGraphBlockConfiguration) {\n        super(RichTypeBoolean, RichTypeFlowGraphInteger, (a) => FlowGraphInteger.FromValue(+a), FlowGraphBlockNames.BooleanToInt, config);\n    }\n}\n\nRegisterClass(FlowGraphBlockNames.BooleanToInt, FlowGraphBooleanToInt);\n\n/**\n * A block that converts a float to a boolean.\n */\nexport class FlowGraphFloatToBoolean extends FlowGraphUnaryOperationBlock<number, boolean> {\n    constructor(config?: IFlowGraphBlockConfiguration) {\n        super(RichTypeNumber, RichTypeBoolean, (a) => !!a, FlowGraphBlockNames.FloatToBoolean, config);\n    }\n}\n\nRegisterClass(FlowGraphBlockNames.FloatToBoolean, FlowGraphFloatToBoolean);\n\n/**\n * A block that converts an integer to a boolean.\n */\nexport class FlowGraphIntToBoolean extends FlowGraphUnaryOperationBlock<FlowGraphInteger, boolean> {\n    constructor(config?: IFlowGraphBlockConfiguration) {\n        super(RichTypeFlowGraphInteger, RichTypeBoolean, (a) => !!a.value, FlowGraphBlockNames.IntToBoolean, config);\n    }\n}\n\nRegisterClass(FlowGraphBlockNames.IntToBoolean, FlowGraphIntToBoolean);\n\n/**\n * A block that converts an integer to a float.\n */\nexport class FlowGraphIntToFloat extends FlowGraphUnaryOperationBlock<FlowGraphInteger, number> {\n    constructor(config?: IFlowGraphBlockConfiguration) {\n        super(RichTypeFlowGraphInteger, RichTypeNumber, (a) => a.value, FlowGraphBlockNames.IntToFloat, config);\n    }\n}\n\nRegisterClass(FlowGraphBlockNames.IntToFloat, FlowGraphIntToFloat);\n\n/**\n * Configuration for the float to int block.\n */\nexport interface IFlowGraphFloatToIntConfiguration extends IFlowGraphBlockConfiguration {\n    /**\n     * The rounding mode to use.\n     * if not defined, it will use the FlowGraphInteger default rounding ( a | 0 )\n     */\n    roundingMode?: \"floor\" | \"ceil\" | \"round\";\n}\n/**\n * A block that converts a float to an integer.\n */\nexport class FlowGraphFloatToInt extends FlowGraphUnaryOperationBlock<number, FlowGraphInteger> {\n    constructor(config?: IFlowGraphFloatToIntConfiguration) {\n        super(\n            RichTypeNumber,\n            RichTypeFlowGraphInteger,\n            (a) => {\n                const roundingMode = config?.roundingMode;\n                switch (roundingMode) {\n                    case \"floor\":\n                        return FlowGraphInteger.FromValue(Math.floor(a));\n                    case \"ceil\":\n                        return FlowGraphInteger.FromValue(Math.ceil(a));\n                    case \"round\":\n                        return FlowGraphInteger.FromValue(Math.round(a));\n                    default:\n                        return FlowGraphInteger.FromValue(a);\n                }\n            },\n            FlowGraphBlockNames.FloatToInt,\n            config\n        );\n    }\n}\n\nRegisterClass(FlowGraphBlockNames.FloatToInt, FlowGraphFloatToInt);\n"],"names":["CacheName","CacheExecIdName","FlowGraphCachedOperationBlock","constructor","outputRichType","config","super","this","value","registerDataOutput","isValid","_updateOutputs","context","cachedExecutionId","_getExecutionVariable","cachedValue","executionId","setValue","calculatedValue","_doOperation","_setExecutionVariable","e","FlowGraphUnaryOperationBlock","inputRichType","resultRichType","_operation","_className","a","registerDataInput","getValue","getClassName","FlowGraphBooleanToFloat","FlowGraphBooleanToInt","FromValue","FlowGraphFloatToBoolean","FlowGraphIntToBoolean","FlowGraphIntToFloat","FlowGraphFloatToInt","roundingMode","Math","floor","ceil","round"],"ignoreList":[],"sourceRoot":""}