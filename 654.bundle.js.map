{"version":3,"file":"654.bundle.js","mappings":"wLAQA,MAAMA,EAAO,2BAiBN,MAAMC,EAqBT,WAAAC,CAAYC,GAjBI,KAAAC,KAAOJ,EAUhB,KAAAK,MAAQ,IAQXC,KAAKC,QAAUJ,EACfG,KAAKE,QAAUF,KAAKC,QAAQE,gBAAgBT,EAChD,CAGO,OAAAU,GACFJ,KAAKC,QAAkB,IAC5B,CAMO,2BAAAI,CAA4BC,EAAiBC,EAAqBC,GACrE,OAAO,KAAWC,mBAA4CH,EAASC,EAAUP,KAAKF,MAAMY,MAAOC,EAAkBC,KACjH,MAAMC,EAAW,IAAIC,MACrBD,EAASE,KAAKf,KAAKC,QAAQI,4BAA4BC,EAASC,EAAUC,IAC1EK,EAASE,KAAKf,KAAKgB,+BAA+BL,EAAkBC,EAAWJ,UACzES,QAAQC,IAAIL,KAE1B,CAEQ,oCAAMG,CAA+BV,EAAiBa,EAAqCX,GAC/F,MAAMY,EAAUpB,KAAKC,QAAQoB,4BAA4Bb,GACnDK,EAAW,IAAIC,MAGfQ,EAAmBH,EAAWI,oBAAsB,EACpDC,EAAkBL,EAAWM,oBAAsB,EAEzDL,EAAQM,4BAA8BJ,EACtCF,EAAQO,qBAAuBH,EAG/B,MAAMI,EAAaT,EAAWS,YAAc,CAAC,EACxCA,EAAWC,kCAAqCD,EAAWC,iCAAiCC,0BAC7FV,EAAQW,8BAA6B,GAIrCZ,EAAWa,oBACVb,EAAWa,kBAAmCC,cAAe,EAC9DpB,EAASE,KACLf,KAAKC,QAAQiC,qBAAqB,GAAG5B,sBAA6Ba,EAAWa,mBAAoBG,IAC7FA,EAAQrC,KAAO,GAAGU,EAAgBV,8BAClCsB,EAAQgB,uBAAyBD,aAKvClB,QAAQC,IAAIL,EACtB,GAGJ,QAAwBnB,IACxB,QAAsBA,GAAM,GAAOG,GAAW,IAAIF,EAAyBE,I","sources":["webpack://@dev/inspector-v2/../loaders/src/glTF/2.0/Extensions/KHR_materials_anisotropy.ts?"],"sourcesContent":["import type { Nullable } from \"core/types\";\r\nimport type { Material } from \"core/Materials/material\";\r\nimport type { IMaterial, ITextureInfo } from \"../glTFLoaderInterfaces\";\r\nimport type { IGLTFLoaderExtension } from \"../glTFLoaderExtension\";\r\nimport { GLTFLoader } from \"../glTFLoader\";\r\nimport type { IKHRMaterialsAnisotropy } from \"babylonjs-gltf2interface\";\r\nimport { registerGLTFExtension, unregisterGLTFExtension } from \"../glTFLoaderExtensionRegistry\";\r\n\r\nconst NAME = \"KHR_materials_anisotropy\";\r\n\r\ndeclare module \"../../glTFFileLoader\" {\r\n    // eslint-disable-next-line jsdoc/require-jsdoc, @typescript-eslint/naming-convention\r\n    export interface GLTFLoaderExtensionOptions {\r\n        /**\r\n         * Defines options for the KHR_materials_anisotropy extension.\r\n         */\r\n        // NOTE: Don't use NAME here as it will break the UMD type declarations.\r\n        [\"KHR_materials_anisotropy\"]: {};\r\n    }\r\n}\r\n\r\n/**\r\n * [Specification](https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_anisotropy)\r\n */\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nexport class KHR_materials_anisotropy implements IGLTFLoaderExtension {\r\n    /**\r\n     * The name of this extension.\r\n     */\r\n    public readonly name = NAME;\r\n\r\n    /**\r\n     * Defines whether this extension is enabled.\r\n     */\r\n    public enabled: boolean;\r\n\r\n    /**\r\n     * Defines a number that determines the order the extensions are applied.\r\n     */\r\n    public order = 195;\r\n\r\n    private _loader: GLTFLoader;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    constructor(loader: GLTFLoader) {\r\n        this._loader = loader;\r\n        this.enabled = this._loader.isExtensionUsed(NAME);\r\n    }\r\n\r\n    /** @internal */\r\n    public dispose() {\r\n        (this._loader as any) = null;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    // eslint-disable-next-line no-restricted-syntax\r\n    public loadMaterialPropertiesAsync(context: string, material: IMaterial, babylonMaterial: Material): Nullable<Promise<void>> {\r\n        return GLTFLoader.LoadExtensionAsync<IKHRMaterialsAnisotropy>(context, material, this.name, async (extensionContext, extension) => {\r\n            const promises = new Array<Promise<any>>();\r\n            promises.push(this._loader.loadMaterialPropertiesAsync(context, material, babylonMaterial));\r\n            promises.push(this._loadAnisotropyPropertiesAsync(extensionContext, extension, babylonMaterial));\r\n            await Promise.all(promises);\r\n        });\r\n    }\r\n\r\n    private async _loadAnisotropyPropertiesAsync(context: string, properties: IKHRMaterialsAnisotropy, babylonMaterial: Material): Promise<void> {\r\n        const adapter = this._loader._getOrCreateMaterialAdapter(babylonMaterial);\r\n        const promises = new Array<Promise<any>>();\r\n\r\n        // Set non-texture properties immediately\r\n        const anisotropyWeight = properties.anisotropyStrength ?? 0;\r\n        const anisotropyAngle = properties.anisotropyRotation ?? 0;\r\n\r\n        adapter.specularRoughnessAnisotropy = anisotropyWeight;\r\n        adapter.geometryTangentAngle = anisotropyAngle;\r\n\r\n        // Check if this is glTF-style anisotropy\r\n        const extensions = properties.extensions ?? {};\r\n        if (!extensions.EXT_materials_anisotropy_openpbr || !extensions.EXT_materials_anisotropy_openpbr.openPbrAnisotropyEnabled) {\r\n            adapter.configureGltfStyleAnisotropy(true);\r\n        }\r\n\r\n        // Load texture if present\r\n        if (properties.anisotropyTexture) {\r\n            (properties.anisotropyTexture as ITextureInfo).nonColorData = true;\r\n            promises.push(\r\n                this._loader.loadTextureInfoAsync(`${context}/anisotropyTexture`, properties.anisotropyTexture, (texture) => {\r\n                    texture.name = `${babylonMaterial.name} (Anisotropy Intensity)`;\r\n                    adapter.geometryTangentTexture = texture;\r\n                })\r\n            );\r\n        }\r\n\r\n        await Promise.all(promises);\r\n    }\r\n}\r\n\r\nunregisterGLTFExtension(NAME);\r\nregisterGLTFExtension(NAME, true, (loader) => new KHR_materials_anisotropy(loader));\r\n"],"names":["NAME","KHR_materials_anisotropy","constructor","loader","name","order","this","_loader","enabled","isExtensionUsed","dispose","loadMaterialPropertiesAsync","context","material","babylonMaterial","LoadExtensionAsync","async","extensionContext","extension","promises","Array","push","_loadAnisotropyPropertiesAsync","Promise","all","properties","adapter","_getOrCreateMaterialAdapter","anisotropyWeight","anisotropyStrength","anisotropyAngle","anisotropyRotation","specularRoughnessAnisotropy","geometryTangentAngle","extensions","EXT_materials_anisotropy_openpbr","openPbrAnisotropyEnabled","configureGltfStyleAnisotropy","anisotropyTexture","nonColorData","loadTextureInfoAsync","texture","geometryTangentTexture"],"ignoreList":[],"sourceRoot":""}