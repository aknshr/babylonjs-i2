{"version":3,"file":"2343.bundle.js","mappings":"iKA6BO,MAAeA,UAAiB,IAMnC,YAAsBC,EAAcC,EAAuBC,GACvDC,MAAMH,EAAMC,GANC,KAAAG,oBAA8B,EAC9B,KAAAC,sBAAgC,EACzC,KAAAC,QAAqC,KACrC,KAAAC,SAA2C,KA8E3C,KAAAC,kBAAoB,KACxBC,KAAKC,OAASD,KAAKR,OAAOU,gBA1Ee,kBAA9BT,EAAQU,oBACfH,KAAKL,mBAAqBF,EAAQU,mBAGM,iBAAjCV,EAAQW,uBACfJ,KAAKJ,sBAAwBH,EAAQW,qBAE7C,CAKA,UAAWH,GACP,OAAOD,KAAKH,OAChB,CAEA,UAAWI,CAAOA,GACd,GAAID,KAAKH,UAAYI,EAArB,CAIA,GAAID,KAAKH,UACLG,KAAKH,QAAQQ,oBAAoBC,eAAeN,KAAKD,oBAEhDC,KAAKO,YAAYP,KAAKH,UACvB,MAAM,IAAIW,MAAM,qBAMxB,GAFAR,KAAKH,QAAUI,EAEXD,KAAKH,UACLG,KAAKH,QAAQQ,oBAAoBI,IAAIT,KAAKD,oBAErCC,KAAKU,SAASV,KAAKH,UACpB,MAAM,IAAIW,MAAM,iBAhBxB,CAmBJ,CAKA,WAAWG,GACP,OAAIX,KAAKF,SACEE,KAAKF,SAETE,KAAKY,sBAChB,CAUgB,OAAAC,GACZnB,MAAMmB,UAENb,KAAKF,UAAUe,UACfb,KAAKF,SAAW,KAEhBE,KAAKH,QAAU,IACnB,CAIU,oBAAAe,GACN,OAAQZ,KAAKF,SAAWE,KAAKc,uBAAuBd,KAAKL,mBAAoBK,KAAKJ,sBACtF,E,+CCjGG,MAAMmB,UAAqBzB,EAS9B,YAAmBC,EAAcC,EAAyBC,GACtDC,MAAMH,EAAMC,EAAQC,GAThB,KAAAuB,QAAkC,KAWtChB,KAAKiB,UAAY,IAAIF,EAAaG,UAAUlB,KAChD,CAGO,gBAAMmB,CAAW1B,GAChBA,EAAQQ,OACRD,KAAKC,OAASR,EAAQQ,cAEhBD,KAAKR,OAAO4B,eAClBpB,KAAKC,OAASD,KAAKR,OAAOU,sBAGxBF,KAAKiB,UAAUI,UAAU5B,IAE3B,QAAwBA,IACxBO,KAAKY,uBAGTZ,KAAKR,OAAO8B,SAAStB,KACzB,CAGgB,OAAAa,GACZnB,MAAMmB,UAENb,KAAKgB,QAAU,KAEfhB,KAAKR,OAAO+B,YAAYvB,KAC5B,CAGA,WAAWwB,GACP,OAAOxB,KAAKiB,UAAUO,OAC1B,CAGA,YAAWC,GACP,OAAOzB,KAAKiB,UAAUQ,QAC1B,CAGA,UAAoBC,GAChB,OAAO1B,KAAKgB,UAAYhB,KAAKgB,QAAU,IAAI,IAAahB,KAAKiB,WACjE,CAGO,YAAAU,GACH,MAAO,cACX,CAEmB,sBAAAb,CAAuBc,EAAqBC,GAC3D,OAAO,IAAI,IAAiB7B,KAAKiB,UAAWW,EAAYC,EAC5D,CAEmB,QAAAnB,CAASoB,GAGxB,QAFkBpC,MAAMgB,SAASoB,KAM7BA,EAAKN,SACLxB,KAAKyB,UAAUM,QAAQD,EAAKN,UAGzB,EACX,CAEmB,WAAAjB,CAAYuB,GAG3B,QAFqBpC,MAAMa,YAAYuB,KAMnCA,EAAKN,SACLxB,KAAKyB,UAAUO,WAAWF,EAAKN,UAG5B,EACX,EAEe,EAAAN,UAAY,cAAc,IAGrC,oBAAce,GACV,OAAOjC,KAAKkC,OAAOD,kBAAoB,IAC3C,CAEA,kBAAcE,GACV,OAAOnC,KAAKkC,OAAOC,gBAAkB,IACzC,E,kDCrGD,MAAeC,UAAyB,IAC3C,YAAsB7C,EAAcC,GAChCE,MAAMH,EAAMC,EAAQ,EACxB,E","sources":["webpack://@dev/inspector-v2/../core/src/AudioV2/abstractAudio/audioBus.ts?","webpack://@dev/inspector-v2/../core/src/AudioV2/webAudio/webAudioBus.ts?","webpack://@dev/inspector-v2/../core/src/AudioV2/abstractAudio/abstractAudioBus.ts?"],"sourcesContent":["import type { Nullable } from \"../../types\";\nimport type { IAbstractAudioBusOptions } from \"./abstractAudioBus\";\nimport { AbstractAudioBus } from \"./abstractAudioBus\";\nimport type { AudioEngineV2 } from \"./audioEngineV2\";\nimport type { MainAudioBus } from \"./mainAudioBus\";\nimport type { AbstractSpatialAudio, ISpatialAudioOptions } from \"./subProperties/abstractSpatialAudio\";\nimport type { AbstractStereoAudio, IStereoAudioOptions } from \"./subProperties/abstractStereoAudio\";\n\n// NB: Secondary audio buses will be added later.\nexport type PrimaryAudioBus = MainAudioBus | AudioBus;\n\n/**\n * Options for creating an audio bus.\n */\nexport interface IAudioBusOptions extends IAbstractAudioBusOptions, ISpatialAudioOptions, IStereoAudioOptions {\n    /**\n     * The output bus of the audio bus. Defaults to the audio engine's default main bus.\n     * @see {@link AudioEngineV2.defaultMainBus}\n     */\n    outBus: PrimaryAudioBus;\n}\n\n/**\n * Abstract class for an audio bus that has spatial audio and stereo output capabilities.\n *\n * Instances of this class can be connected to other audio buses.\n *\n * Audio buses are created by the {@link CreateAudioBusAsync} function.\n */\nexport abstract class AudioBus extends AbstractAudioBus {\n    private readonly _spatialAutoUpdate: boolean = true;\n    private readonly _spatialMinUpdateTime: number = 0;\n    private _outBus: Nullable<PrimaryAudioBus> = null;\n    private _spatial: Nullable<AbstractSpatialAudio> = null;\n\n    protected constructor(name: string, engine: AudioEngineV2, options: Partial<IAudioBusOptions>) {\n        super(name, engine);\n\n        if (typeof options.spatialAutoUpdate === \"boolean\") {\n            this._spatialAutoUpdate = options.spatialAutoUpdate;\n        }\n\n        if (typeof options.spatialMinUpdateTime === \"number\") {\n            this._spatialMinUpdateTime = options.spatialMinUpdateTime;\n        }\n    }\n\n    /**\n     * The output bus of the audio bus. Defaults to the audio engine's default main bus.\n     */\n    public get outBus(): Nullable<PrimaryAudioBus> {\n        return this._outBus;\n    }\n\n    public set outBus(outBus: Nullable<PrimaryAudioBus>) {\n        if (this._outBus === outBus) {\n            return;\n        }\n\n        if (this._outBus) {\n            this._outBus.onDisposeObservable.removeCallback(this._onOutBusDisposed);\n\n            if (!this._disconnect(this._outBus)) {\n                throw new Error(\"Disconnect failed\");\n            }\n        }\n\n        this._outBus = outBus;\n\n        if (this._outBus) {\n            this._outBus.onDisposeObservable.add(this._onOutBusDisposed);\n\n            if (!this._connect(this._outBus)) {\n                throw new Error(\"Connect failed\");\n            }\n        }\n    }\n\n    /**\n     * The spatial audio features.\n     */\n    public get spatial(): AbstractSpatialAudio {\n        if (this._spatial) {\n            return this._spatial;\n        }\n        return this._initSpatialProperty();\n    }\n\n    /**\n     * The stereo features of the audio bus.\n     */\n    public abstract readonly stereo: AbstractStereoAudio;\n\n    /**\n     * Releases associated resources.\n     */\n    public override dispose(): void {\n        super.dispose();\n\n        this._spatial?.dispose();\n        this._spatial = null;\n\n        this._outBus = null;\n    }\n\n    protected abstract _createSpatialProperty(autoUpdate: boolean, minUpdateTime: number): AbstractSpatialAudio;\n\n    protected _initSpatialProperty(): AbstractSpatialAudio {\n        return (this._spatial = this._createSpatialProperty(this._spatialAutoUpdate, this._spatialMinUpdateTime));\n    }\n\n    private _onOutBusDisposed = () => {\n        this.outBus = this.engine.defaultMainBus;\n    };\n}\n","import type { Nullable } from \"core/types\";\nimport type { AbstractAudioNode } from \"../abstractAudio/abstractAudioNode\";\nimport type { IAudioBusOptions } from \"../abstractAudio/audioBus\";\nimport { AudioBus } from \"../abstractAudio/audioBus\";\nimport { _HasSpatialAudioOptions, type AbstractSpatialAudio } from \"../abstractAudio/subProperties/abstractSpatialAudio\";\nimport { _StereoAudio } from \"../abstractAudio/subProperties/stereoAudio\";\nimport { _WebAudioBusAndSoundSubGraph } from \"./subNodes/webAudioBusAndSoundSubGraph\";\nimport { _SpatialWebAudio } from \"./subProperties/spatialWebAudio\";\nimport type { _WebAudioEngine } from \"./webAudioEngine\";\nimport type { IWebAudioInNode, IWebAudioSuperNode } from \"./webAudioNode\";\n\n/** @internal */\nexport class _WebAudioBus extends AudioBus implements IWebAudioSuperNode {\n    private _stereo: Nullable<_StereoAudio> = null;\n\n    protected _subGraph: _WebAudioBusAndSoundSubGraph;\n\n    /** @internal */\n    public override readonly engine: _WebAudioEngine;\n\n    /** @internal */\n    public constructor(name: string, engine: _WebAudioEngine, options: Partial<IAudioBusOptions>) {\n        super(name, engine, options);\n\n        this._subGraph = new _WebAudioBus._SubGraph(this);\n    }\n\n    /** @internal */\n    public async _initAsync(options: Partial<IAudioBusOptions>): Promise<void> {\n        if (options.outBus) {\n            this.outBus = options.outBus;\n        } else {\n            await this.engine.isReadyPromise;\n            this.outBus = this.engine.defaultMainBus;\n        }\n\n        await this._subGraph.initAsync(options);\n\n        if (_HasSpatialAudioOptions(options)) {\n            this._initSpatialProperty();\n        }\n\n        this.engine._addNode(this);\n    }\n\n    /** @internal */\n    public override dispose(): void {\n        super.dispose();\n\n        this._stereo = null;\n\n        this.engine._removeNode(this);\n    }\n\n    /** @internal */\n    public get _inNode() {\n        return this._subGraph._inNode;\n    }\n\n    /** @internal */\n    public get _outNode() {\n        return this._subGraph._outNode;\n    }\n\n    /** @internal */\n    public override get stereo(): _StereoAudio {\n        return this._stereo ?? (this._stereo = new _StereoAudio(this._subGraph));\n    }\n\n    /** @internal */\n    public getClassName(): string {\n        return \"_WebAudioBus\";\n    }\n\n    protected override _createSpatialProperty(autoUpdate: boolean, minUpdateTime: number): AbstractSpatialAudio {\n        return new _SpatialWebAudio(this._subGraph, autoUpdate, minUpdateTime);\n    }\n\n    protected override _connect(node: IWebAudioInNode): boolean {\n        const connected = super._connect(node);\n\n        if (!connected) {\n            return false;\n        }\n\n        if (node._inNode) {\n            this._outNode?.connect(node._inNode);\n        }\n\n        return true;\n    }\n\n    protected override _disconnect(node: IWebAudioInNode): boolean {\n        const disconnected = super._disconnect(node);\n\n        if (!disconnected) {\n            return false;\n        }\n\n        if (node._inNode) {\n            this._outNode?.disconnect(node._inNode);\n        }\n\n        return true;\n    }\n\n    private static _SubGraph = class extends _WebAudioBusAndSoundSubGraph {\n        protected override _owner: _WebAudioBus;\n\n        protected get _downstreamNodes(): Nullable<Set<AbstractAudioNode>> {\n            return this._owner._downstreamNodes ?? null;\n        }\n\n        protected get _upstreamNodes(): Nullable<Set<AbstractAudioNode>> {\n            return this._owner._upstreamNodes ?? null;\n        }\n    };\n}\n","import { AudioNodeType } from \"./abstractAudioNode\";\nimport type { IAbstractAudioOutNodeOptions } from \"./abstractAudioOutNode\";\nimport { AbstractAudioOutNode } from \"./abstractAudioOutNode\";\nimport type { AudioEngineV2 } from \"./audioEngineV2\";\n\n/** @internal */\nexport interface IAbstractAudioBusOptions extends IAbstractAudioOutNodeOptions {}\n\n/**\n * Abstract class representing an audio bus with volume control.\n *\n * An audio bus is a node in the audio graph that can have multiple inputs and outputs. It is typically used to group\n * sounds together and apply effects to them.\n */\nexport abstract class AbstractAudioBus extends AbstractAudioOutNode {\n    protected constructor(name: string, engine: AudioEngineV2) {\n        super(name, engine, AudioNodeType.HAS_INPUTS_AND_OUTPUTS);\n    }\n}\n"],"names":["AudioBus","name","engine","options","super","_spatialAutoUpdate","_spatialMinUpdateTime","_outBus","_spatial","_onOutBusDisposed","this","outBus","defaultMainBus","spatialAutoUpdate","spatialMinUpdateTime","onDisposeObservable","removeCallback","_disconnect","Error","add","_connect","spatial","_initSpatialProperty","dispose","_createSpatialProperty","_WebAudioBus","_stereo","_subGraph","_SubGraph","_initAsync","isReadyPromise","initAsync","_addNode","_removeNode","_inNode","_outNode","stereo","getClassName","autoUpdate","minUpdateTime","node","connect","disconnect","_downstreamNodes","_owner","_upstreamNodes","AbstractAudioBus"],"ignoreList":[],"sourceRoot":""}