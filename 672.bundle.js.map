{"version":3,"file":"672.bundle.js","mappings":"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","sources":["webpack://@dev/inspector-v2/../loaders/src/glTF/2.0/glTFLoaderAnimation.ts?","webpack://@dev/inspector-v2/../loaders/src/glTF/2.0/Extensions/KHR_animation_pointer.data.ts?","webpack://@dev/inspector-v2/../loaders/src/glTF/2.0/Extensions/KHR_animation_pointer.ts?"],"sourcesContent":["import { Animation } from \"core/Animations/animation\";\r\nimport { Quaternion, Vector3 } from \"core/Maths/math.vector\";\r\nimport type { INode } from \"./glTFLoaderInterfaces\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport { SetInterpolationForKey } from \"./Extensions/objectModelMapping\";\r\n\r\n/** @internal */\r\nexport type GetValueFn = (target: any, source: Float32Array, offset: number, scale: number) => any;\r\n\r\n/** @internal */\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nexport function getVector3(_target: any, source: Float32Array, offset: number, scale: number): Vector3 {\r\n    return Vector3.FromArray(source, offset).scaleInPlace(scale);\r\n}\r\n\r\n/** @internal */\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nexport function getQuaternion(_target: any, source: Float32Array, offset: number, scale: number): Quaternion {\r\n    return Quaternion.FromArray(source, offset).scaleInPlace(scale);\r\n}\r\n\r\n/** @internal */\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nexport function getWeights(target: INode, source: Float32Array, offset: number, scale: number): Array<number> {\r\n    const value = new Array<number>(target._numMorphTargets!);\r\n    for (let i = 0; i < value.length; i++) {\r\n        value[i] = source[offset++] * scale;\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n/** @internal */\r\nexport abstract class AnimationPropertyInfo {\r\n    /** @internal */\r\n    public constructor(\r\n        public readonly type: number,\r\n        public readonly name: string,\r\n        public readonly getValue: GetValueFn,\r\n        public readonly getStride: (target: any) => number\r\n    ) {}\r\n\r\n    protected _buildAnimation(name: string, fps: number, keys: any[]): Animation {\r\n        const babylonAnimation = new Animation(name, this.name, fps, this.type);\r\n        babylonAnimation.setKeys(keys, true);\r\n        return babylonAnimation;\r\n    }\r\n\r\n    /** @internal */\r\n    public abstract buildAnimations(target: any, name: string, fps: number, keys: any[]): { babylonAnimatable: IAnimatable; babylonAnimation: Animation }[];\r\n}\r\n\r\n/** @internal */\r\nexport class TransformNodeAnimationPropertyInfo extends AnimationPropertyInfo {\r\n    /** @internal */\r\n    public buildAnimations(target: INode, name: string, fps: number, keys: any[]) {\r\n        const babylonAnimations: { babylonAnimatable: IAnimatable; babylonAnimation: Animation }[] = [];\r\n        babylonAnimations.push({ babylonAnimatable: target._babylonTransformNode!, babylonAnimation: this._buildAnimation(name, fps, keys) });\r\n        return babylonAnimations;\r\n    }\r\n}\r\n\r\n/** @internal */\r\nexport class WeightAnimationPropertyInfo extends AnimationPropertyInfo {\r\n    public buildAnimations(target: INode, name: string, fps: number, keys: any[]) {\r\n        const babylonAnimations: { babylonAnimatable: IAnimatable; babylonAnimation: Animation }[] = [];\r\n        if (target._numMorphTargets) {\r\n            for (let targetIndex = 0; targetIndex < target._numMorphTargets; targetIndex++) {\r\n                const babylonAnimation = new Animation(`${name}_${targetIndex}`, this.name, fps, this.type);\r\n                babylonAnimation.setKeys(\r\n                    keys.map((key) => ({\r\n                        frame: key.frame,\r\n                        inTangent: key.inTangent ? key.inTangent[targetIndex] : undefined,\r\n                        value: key.value[targetIndex],\r\n                        outTangent: key.outTangent ? key.outTangent[targetIndex] : undefined,\r\n                        interpolation: key.interpolation,\r\n                    })),\r\n                    true\r\n                );\r\n\r\n                if (target._primitiveBabylonMeshes) {\r\n                    for (const babylonMesh of target._primitiveBabylonMeshes) {\r\n                        if (babylonMesh.morphTargetManager) {\r\n                            const morphTarget = babylonMesh.morphTargetManager.getTarget(targetIndex);\r\n                            const babylonAnimationClone = babylonAnimation.clone();\r\n                            morphTarget.animations.push(babylonAnimationClone);\r\n                            babylonAnimations.push({ babylonAnimatable: morphTarget, babylonAnimation: babylonAnimationClone });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return babylonAnimations;\r\n    }\r\n}\r\n\r\nSetInterpolationForKey(\"/nodes/{}/translation\", [new TransformNodeAnimationPropertyInfo(Animation.ANIMATIONTYPE_VECTOR3, \"position\", getVector3, () => 3)]);\r\nSetInterpolationForKey(\"/nodes/{}/rotation\", [new TransformNodeAnimationPropertyInfo(Animation.ANIMATIONTYPE_QUATERNION, \"rotationQuaternion\", getQuaternion, () => 4)]);\r\nSetInterpolationForKey(\"/nodes/{}/scale\", [new TransformNodeAnimationPropertyInfo(Animation.ANIMATIONTYPE_VECTOR3, \"scaling\", getVector3, () => 3)]);\r\nSetInterpolationForKey(\"/nodes/{}/weights\", [new WeightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"influence\", getWeights, (target) => target._numMorphTargets!)]);\r\n","/* eslint-disable @typescript-eslint/naming-convention */\r\n\r\nimport { Animation } from \"core/Animations/animation\";\r\nimport type { ICamera, IKHRLightsPunctual_Light, IMaterial, INode } from \"../glTFLoaderInterfaces\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport { AnimationPropertyInfo } from \"../glTFLoaderAnimation\";\r\nimport { Color3 } from \"core/Maths/math.color\";\r\nimport { SetInterpolationForKey } from \"./objectModelMapping\";\r\n\r\nfunction getColor3(_target: any, source: Float32Array, offset: number, scale: number): Color3 {\r\n    return Color3.FromArray(source, offset).scale(scale);\r\n}\r\n\r\nfunction getAlpha(_target: any, source: Float32Array, offset: number, scale: number): number {\r\n    return source[offset + 3] * scale;\r\n}\r\n\r\nfunction getFloat(_target: any, source: Float32Array, offset: number, scale: number): number {\r\n    return source[offset] * scale;\r\n}\r\n\r\nfunction getMinusFloat(_target: any, source: Float32Array, offset: number, scale: number): number {\r\n    return -source[offset] * scale;\r\n}\r\n\r\nfunction getNextFloat(_target: any, source: Float32Array, offset: number, scale: number): number {\r\n    return source[offset + 1] * scale;\r\n}\r\n\r\nfunction getFloatBy2(_target: any, source: Float32Array, offset: number, scale: number): number {\r\n    return source[offset] * scale * 2;\r\n}\r\n\r\nfunction getTextureTransformTree(textureName: string) {\r\n    return {\r\n        scale: [\r\n            new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, `${textureName}.uScale`, getFloat, () => 2),\r\n            new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, `${textureName}.vScale`, getNextFloat, () => 2),\r\n        ],\r\n        offset: [\r\n            new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, `${textureName}.uOffset`, getFloat, () => 2),\r\n            new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, `${textureName}.vOffset`, getNextFloat, () => 2),\r\n        ],\r\n        rotation: [new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, `${textureName}.wAng`, getMinusFloat, () => 1)],\r\n    };\r\n}\r\n\r\nclass CameraAnimationPropertyInfo extends AnimationPropertyInfo {\r\n    /** @internal */\r\n    public buildAnimations(target: ICamera, name: string, fps: number, keys: any[]) {\r\n        return [{ babylonAnimatable: target._babylonCamera!, babylonAnimation: this._buildAnimation(name, fps, keys) }];\r\n    }\r\n}\r\n\r\nclass MaterialAnimationPropertyInfo extends AnimationPropertyInfo {\r\n    /** @internal */\r\n    public buildAnimations(target: IMaterial, name: string, fps: number, keys: any[]) {\r\n        const babylonAnimations: { babylonAnimatable: IAnimatable; babylonAnimation: Animation }[] = [];\r\n        for (const fillMode in target._data!) {\r\n            babylonAnimations.push({\r\n                babylonAnimatable: target._data[fillMode].babylonMaterial,\r\n                babylonAnimation: this._buildAnimation(name, fps, keys),\r\n            });\r\n        }\r\n        return babylonAnimations;\r\n    }\r\n}\r\n\r\nclass LightAnimationPropertyInfo extends AnimationPropertyInfo {\r\n    /** @internal */\r\n    public buildAnimations(target: IKHRLightsPunctual_Light, name: string, fps: number, keys: any[]) {\r\n        return [{ babylonAnimatable: target._babylonLight!, babylonAnimation: this._buildAnimation(name, fps, keys) }];\r\n    }\r\n}\r\n\r\nclass MeshAnimationPropertyInfo extends AnimationPropertyInfo {\r\n    /** @internal */\r\n    public buildAnimations(target: INode, name: string, fps: number, keys: any[]) {\r\n        return target._primitiveBabylonMeshes\r\n            ? target._primitiveBabylonMeshes.map((mesh) => ({ babylonAnimatable: mesh, babylonAnimation: this._buildAnimation(name, fps, keys) }))\r\n            : [];\r\n    }\r\n}\r\n\r\nSetInterpolationForKey(\"/cameras/{}/orthographic/xmag\", [\r\n    new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"orthoLeft\", getMinusFloat, () => 1),\r\n    new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"orthoRight\", getNextFloat, () => 1),\r\n]);\r\n\r\nSetInterpolationForKey(\"/cameras/{}/orthographic/ymag\", [\r\n    new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"orthoBottom\", getMinusFloat, () => 1),\r\n    new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"orthoTop\", getNextFloat, () => 1),\r\n]);\r\n\r\nSetInterpolationForKey(\"/cameras/{}/orthographic/zfar\", [new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"maxZ\", getFloat, () => 1)]);\r\nSetInterpolationForKey(\"/cameras/{}/orthographic/znear\", [new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"minZ\", getFloat, () => 1)]);\r\n\r\nSetInterpolationForKey(\"/cameras/{}/perspective/yfov\", [new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"fov\", getFloat, () => 1)]);\r\nSetInterpolationForKey(\"/cameras/{}/perspective/zfar\", [new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"maxZ\", getFloat, () => 1)]);\r\nSetInterpolationForKey(\"/cameras/{}/perspective/znear\", [new CameraAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"minZ\", getFloat, () => 1)]);\r\n\r\n// add interpolation to the materials mapping\r\nSetInterpolationForKey(\"/materials/{}/pbrMetallicRoughness/baseColorFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"albedoColor\", getColor3, () => 4),\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"alpha\", getAlpha, () => 4),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/pbrMetallicRoughness/metallicFactor\", [new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"metallic\", getFloat, () => 1)]);\r\nSetInterpolationForKey(\"/materials/{}/pbrMetallicRoughness/metallicFactor\", [new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"roughness\", getFloat, () => 1)]);\r\nconst baseColorTextureInterpolation = getTextureTransformTree(\"albedoTexture\");\r\nSetInterpolationForKey(\"/materials/{}/pbrMetallicRoughness/baseColorTexture/extensions/KHR_texture_transform/scale\", baseColorTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/pbrMetallicRoughness/baseColorTexture/extensions/KHR_texture_transform/offset\", baseColorTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/pbrMetallicRoughness/baseColorTexture/extensions/KHR_texture_transform/rotation\", baseColorTextureInterpolation.rotation);\r\n\r\nconst metallicRoughnessTextureInterpolation = getTextureTransformTree(\"metallicTexture\");\r\nSetInterpolationForKey(\"//materials/{}/pbrMetallicRoughness/metallicRoughnessTexture/scale\", metallicRoughnessTextureInterpolation.scale);\r\nSetInterpolationForKey(\"//materials/{}/pbrMetallicRoughness/metallicRoughnessTexture/offset\", metallicRoughnessTextureInterpolation.offset);\r\nSetInterpolationForKey(\"//materials/{}/pbrMetallicRoughness/metallicRoughnessTexture/rotation\", metallicRoughnessTextureInterpolation.rotation);\r\n\r\nSetInterpolationForKey(\"/materials/{}/emissiveFactor\", [new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"emissiveColor\", getColor3, () => 3)]);\r\nconst normalTextureInterpolation = getTextureTransformTree(\"bumpTexture\");\r\nSetInterpolationForKey(\"/materials/{}/normalTexture/scale\", [new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"bumpTexture.level\", getFloat, () => 1)]);\r\n\r\nSetInterpolationForKey(\"/materials/{}/normalTexture/extensions/KHR_texture_transform/scale\", normalTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/normalTexture/extensions/KHR_texture_transform/offset\", normalTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/normalTexture/extensions/KHR_texture_transform/rotation\", normalTextureInterpolation.rotation);\r\n\r\nSetInterpolationForKey(\"/materials/{}/occlusionTexture/strength\", [new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"ambientTextureStrength\", getFloat, () => 1)]);\r\n\r\nconst occlusionTextureInterpolation = getTextureTransformTree(\"ambientTexture\");\r\nSetInterpolationForKey(\"/materials/{}/occlusionTexture/extensions/KHR_texture_transform/scale\", occlusionTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/occlusionTexture/extensions/KHR_texture_transform/offset\", occlusionTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/occlusionTexture/extensions/KHR_texture_transform/rotation\", occlusionTextureInterpolation.rotation);\r\nconst emissiveTextureInterpolation = getTextureTransformTree(\"emissiveTexture\");\r\nSetInterpolationForKey(\"/materials/{}/emissiveTexture/extensions/KHR_texture_transform/scale\", emissiveTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/emissiveTexture/extensions/KHR_texture_transform/offset\", emissiveTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/emissiveTexture/extensions/KHR_texture_transform/rotation\", emissiveTextureInterpolation.rotation);\r\n\r\n// materials extensions\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_anisotropy/anisotropyStrength\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"anisotropy.intensity\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_anisotropy/anisotropyRotation\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"anisotropy.angle\", getFloat, () => 1),\r\n]);\r\nconst anisotropyTextureInterpolation = getTextureTransformTree(\"anisotropy.texture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_anisotropy/anisotropyTexture/extensions/KHR_texture_transform/scale\", anisotropyTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_anisotropy/anisotropyTexture/extensions/KHR_texture_transform/offset\", anisotropyTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_anisotropy/anisotropyTexture/extensions/KHR_texture_transform/rotation\", anisotropyTextureInterpolation.rotation);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"clearCoat.intensity\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatRoughnessFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"clearCoat.roughness\", getFloat, () => 1),\r\n]);\r\nconst clearcoatTextureInterpolation = getTextureTransformTree(\"clearCoat.texture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatTexture/extensions/KHR_texture_transform/scale\", clearcoatTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatTexture/extensions/KHR_texture_transform/offset\", clearcoatTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatTexture/extensions/KHR_texture_transform/rotation\", clearcoatTextureInterpolation.rotation);\r\nconst clearcoatNormalTextureInterpolation = getTextureTransformTree(\"clearCoat.bumpTexture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatNormalTexture/scale\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"clearCoat.bumpTexture.level\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatNormalTexture/extensions/KHR_texture_transform/scale\", clearcoatNormalTextureInterpolation.scale);\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatNormalTexture/extensions/KHR_texture_transform/offset\",\r\n    clearcoatNormalTextureInterpolation.offset\r\n);\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatNormalTexture/extensions/KHR_texture_transform/rotation\",\r\n    clearcoatNormalTextureInterpolation.rotation\r\n);\r\nconst clearcoatRoughnessTextureInterpolation = getTextureTransformTree(\"clearCoat.textureRoughness\");\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatRoughnessTexture/extensions/KHR_texture_transform/scale\",\r\n    clearcoatRoughnessTextureInterpolation.scale\r\n);\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatRoughnessTexture/extensions/KHR_texture_transform/offset\",\r\n    clearcoatRoughnessTextureInterpolation.offset\r\n);\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_clearcoat/clearcoatRoughnessTexture/extensions/KHR_texture_transform/rotation\",\r\n    clearcoatRoughnessTextureInterpolation.rotation\r\n);\r\n\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_dispersion/dispersionFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"subSurface.dispersion\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_emissive_strength/emissiveStrength\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"emissiveIntensity\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_ior/ior\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"indexOfRefraction\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_iridescence/iridescenceFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"iridescence.intensity\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_iridescence/iridescenceIor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"iridescence.indexOfRefraction\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessMinimum\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"iridescence.minimumThickness\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessMaximum\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"iridescence.maximumThickness\", getFloat, () => 1),\r\n]);\r\n\r\nconst iridescenceTextureInterpolation = getTextureTransformTree(\"iridescence.texture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_iridescence/iridescenceTexture/extensions/KHR_texture_transform/scale\", iridescenceTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_iridescence/iridescenceTexture/extensions/KHR_texture_transform/offset\", iridescenceTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_iridescence/iridescenceTexture/extensions/KHR_texture_transform/rotation\", iridescenceTextureInterpolation.rotation);\r\n\r\nconst iridescenceThicknessTextureInterpolation = getTextureTransformTree(\"iridescence.thicknessTexture\");\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessTexture/extensions/KHR_texture_transform/scale\",\r\n    iridescenceThicknessTextureInterpolation.scale\r\n);\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessTexture/extensions/KHR_texture_transform/offset\",\r\n    iridescenceThicknessTextureInterpolation.offset\r\n);\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_iridescence/iridescenceThicknessTexture/extensions/KHR_texture_transform/rotation\",\r\n    iridescenceThicknessTextureInterpolation.rotation\r\n);\r\n\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_sheen/sheenColorFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"sheen.color\", getColor3, () => 3),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_sheen/sheenRoughnessFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"sheen.roughness\", getFloat, () => 1),\r\n]);\r\n\r\nconst sheenTextureInterpolation = getTextureTransformTree(\"sheen.texture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_sheen/sheenColorTexture/extensions/KHR_texture_transform/scale\", sheenTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_sheen/sheenColorTexture/extensions/KHR_texture_transform/offset\", sheenTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_sheen/sheenColorTexture/extensions/KHR_texture_transform/rotation\", sheenTextureInterpolation.rotation);\r\n\r\nconst sheenRoughnessTextureInterpolation = getTextureTransformTree(\"sheen.textureRoughness\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_sheen/sheenRoughnessTexture/extensions/KHR_texture_transform/scale\", sheenRoughnessTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_sheen/sheenRoughnessTexture/extensions/KHR_texture_transform/offset\", sheenRoughnessTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_sheen/sheenRoughnessTexture/extensions/KHR_texture_transform/rotation\", sheenRoughnessTextureInterpolation.rotation);\r\n\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_specular/specularFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"metallicF0Factor\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_specular/specularColorFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"metallicReflectanceColor\", getColor3, () => 3),\r\n]);\r\n\r\nconst specularTextureInterpolation = getTextureTransformTree(\"metallicReflectanceTexture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_specular/specularTexture/extensions/KHR_texture_transform/scale\", specularTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_specular/specularTexture/extensions/KHR_texture_transform/offset\", specularTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_specular/specularTexture/extensions/KHR_texture_transform/rotation\", specularTextureInterpolation.rotation);\r\nconst specularColorTextureInterpolation = getTextureTransformTree(\"reflectanceTexture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_specular/specularColorTexture/extensions/KHR_texture_transform/scale\", specularColorTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_specular/specularColorTexture/extensions/KHR_texture_transform/offset\", specularColorTextureInterpolation.offset);\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_specular/specularColorTexture/extensions/KHR_texture_transform/rotation\",\r\n    specularColorTextureInterpolation.rotation\r\n);\r\n\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_transmission/transmissionFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"subSurface.refractionIntensity\", getFloat, () => 1),\r\n]);\r\nconst transmissionTextureInterpolation = getTextureTransformTree(\"subSurface.refractionIntensityTexture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_transmission/transmissionTexture/extensions/KHR_texture_transform/scale\", transmissionTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_transmission/transmissionTexture/extensions/KHR_texture_transform/offset\", transmissionTextureInterpolation.offset);\r\nSetInterpolationForKey(\r\n    \"/materials/{}/extensions/KHR_materials_transmission/transmissionTexture/extensions/KHR_texture_transform/rotation\",\r\n    transmissionTextureInterpolation.rotation\r\n);\r\n\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_volume/attenuationColor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"subSurface.tintColor\", getColor3, () => 3),\r\n]);\r\n\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_volume/attenuationDistance\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"subSurface.tintColorAtDistance\", getFloat, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_volume/thicknessFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"subSurface.maximumThickness\", getFloat, () => 1),\r\n]);\r\n\r\nconst thicknessTextureInterpolation = getTextureTransformTree(\"subSurface.thicknessTexture\");\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_volume/thicknessTexture/extensions/KHR_texture_transform/scale\", thicknessTextureInterpolation.scale);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_volume/thicknessTexture/extensions/KHR_texture_transform/offset\", thicknessTextureInterpolation.offset);\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_volume/thicknessTexture/extensions/KHR_texture_transform/rotation\", thicknessTextureInterpolation.rotation);\r\n\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"subSurface.translucencyIntensity\", getFloat, () => 1),\r\n]);\r\n\r\nconst diffuseTransmissionTextureInterpolation = getTextureTransformTree(\"subSurface.translucencyIntensityTexture\");\r\nSetInterpolationForKey(\r\n    \"materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionTexture/extensions/KHR_texture_transform/scale\",\r\n    diffuseTransmissionTextureInterpolation.scale\r\n);\r\nSetInterpolationForKey(\r\n    \"materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionTexture/extensions/KHR_texture_transform/offset\",\r\n    diffuseTransmissionTextureInterpolation.offset\r\n);\r\nSetInterpolationForKey(\r\n    \"materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionTexture/extensions/KHR_texture_transform/rotation\",\r\n    diffuseTransmissionTextureInterpolation.rotation\r\n);\r\n\r\nSetInterpolationForKey(\"/materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionColorFactor\", [\r\n    new MaterialAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"subSurface.translucencyColor\", getColor3, () => 3),\r\n]);\r\n\r\nconst diffuseTransmissionColorTextureInterpolation = getTextureTransformTree(\"subSurface.translucencyColorTexture\");\r\nSetInterpolationForKey(\r\n    \"materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionColorTexture/extensions/KHR_texture_transform/scale\",\r\n    diffuseTransmissionColorTextureInterpolation.scale\r\n);\r\nSetInterpolationForKey(\r\n    \"materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionColorTexture/extensions/KHR_texture_transform/offset\",\r\n    diffuseTransmissionColorTextureInterpolation.offset\r\n);\r\nSetInterpolationForKey(\r\n    \"materials/{}/extensions/KHR_materials_diffuse_transmission/diffuseTransmissionColorTexture/extensions/KHR_texture_transform/rotation\",\r\n    diffuseTransmissionColorTextureInterpolation.rotation\r\n);\r\n\r\nSetInterpolationForKey(\"/extensions/KHR_lights_punctual/lights/{}/color\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"diffuse\", getColor3, () => 3)]);\r\nSetInterpolationForKey(\"/extensions/KHR_lights_punctual/lights/{}/intensity\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"intensity\", getFloat, () => 1)]);\r\nSetInterpolationForKey(\"/extensions/KHR_lights_punctual/lights/{}/range\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"range\", getFloat, () => 1)]);\r\nSetInterpolationForKey(\"/extensions/KHR_lights_punctual/lights/{}/spot/innerConeAngle\", [\r\n    new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"innerAngle\", getFloatBy2, () => 1),\r\n]);\r\nSetInterpolationForKey(\"/extensions/KHR_lights_punctual/lights/{}/spot/outerConeAngle\", [\r\n    new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"angle\", getFloatBy2, () => 1),\r\n]);\r\n\r\nSetInterpolationForKey(\"/extensions/EXT_lights_area/lights/{}/color\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"diffuse\", getColor3, () => 3)]);\r\nSetInterpolationForKey(\"/extensions/EXT_lights_area/lights/{}/intensity\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"intensity\", getFloat, () => 1)]);\r\nSetInterpolationForKey(\"/extensions/EXT_lights_area/lights/{}/size\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"radius\", getFloat, () => 1)]);\r\nSetInterpolationForKey(\"/extensions/EXT_lights_area/lights/{}/rect/aspect\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"radius\", getFloat, () => 1)]);\r\n\r\nSetInterpolationForKey(\"/nodes/{}/extensions/EXT_lights_ies/color\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_COLOR3, \"diffuse\", getColor3, () => 3)]);\r\nSetInterpolationForKey(\"/nodes/{}/extensions/EXT_lights_ies/multiplier\", [new LightAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"intensity\", getFloat, () => 1)]);\r\n\r\nSetInterpolationForKey(\"/nodes/{}/extensions/KHR_node_visibility/visible\", [new MeshAnimationPropertyInfo(Animation.ANIMATIONTYPE_FLOAT, \"isVisible\", getFloat, () => 1)]);\r\n","import type { IGLTFLoaderExtension } from \"../glTFLoaderExtension\";\r\nimport type { GLTFLoader } from \"../glTFLoader\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Animation } from \"core/Animations/animation\";\r\nimport type { IAnimatable } from \"core/Animations/animatable.interface\";\r\nimport type { IAnimation, IAnimationChannel } from \"../glTFLoaderInterfaces\";\r\nimport type { IKHRAnimationPointer } from \"babylonjs-gltf2interface\";\r\nimport { AnimationChannelTargetPath } from \"babylonjs-gltf2interface\";\r\nimport { Logger } from \"core/Misc/logger\";\r\nimport type { GLTFPathToObjectConverter } from \"./gltfPathToObjectConverter\";\r\nimport { registerGLTFExtension, unregisterGLTFExtension } from \"../glTFLoaderExtensionRegistry\";\r\nimport { GetPathToObjectConverter } from \"./objectModelMapping\";\r\nimport \"./KHR_animation_pointer.data\";\r\n\r\nconst NAME = \"KHR_animation_pointer\";\r\n\r\ndeclare module \"../../glTFFileLoader\" {\r\n    // eslint-disable-next-line jsdoc/require-jsdoc, @typescript-eslint/naming-convention\r\n    export interface GLTFLoaderExtensionOptions {\r\n        /**\r\n         * Defines options for the KHR_animation_pointer extension.\r\n         */\r\n        // NOTE: Don't use NAME here as it will break the UMD type declarations.\r\n        [\"KHR_animation_pointer\"]: {};\r\n    }\r\n}\r\n\r\n/**\r\n * [Specification PR](https://github.com/KhronosGroup/glTF/pull/2147)\r\n * !!! Experimental Extension Subject to Changes !!!\r\n */\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nexport class KHR_animation_pointer implements IGLTFLoaderExtension {\r\n    /**\r\n     * The name of this extension.\r\n     */\r\n    public readonly name = NAME;\r\n\r\n    private _loader: GLTFLoader;\r\n    private _pathToObjectConverter?: GLTFPathToObjectConverter<any, any, any>;\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    constructor(loader: GLTFLoader) {\r\n        this._loader = loader;\r\n        this._pathToObjectConverter = GetPathToObjectConverter(this._loader.gltf);\r\n    }\r\n\r\n    /**\r\n     * Defines whether this extension is enabled.\r\n     */\r\n    public get enabled(): boolean {\r\n        return this._loader.isExtensionUsed(NAME);\r\n    }\r\n\r\n    /** @internal */\r\n    public dispose() {\r\n        (this._loader as any) = null;\r\n        delete this._pathToObjectConverter; // GC\r\n    }\r\n\r\n    /**\r\n     * Loads a glTF animation channel.\r\n     * @param context The context when loading the asset\r\n     * @param animationContext The context of the animation when loading the asset\r\n     * @param animation The glTF animation property\r\n     * @param channel The glTF animation channel property\r\n     * @param onLoad Called for each animation loaded\r\n     * @returns A void promise that resolves when the load is complete or null if not handled\r\n     */\r\n    // eslint-disable-next-line no-restricted-syntax\r\n    public _loadAnimationChannelAsync(\r\n        context: string,\r\n        animationContext: string,\r\n        animation: IAnimation,\r\n        channel: IAnimationChannel,\r\n        onLoad: (babylonAnimatable: IAnimatable, babylonAnimation: Animation) => void\r\n    ): Nullable<Promise<void>> {\r\n        const extension = channel.target.extensions?.KHR_animation_pointer as IKHRAnimationPointer;\r\n        if (!extension || !this._pathToObjectConverter) {\r\n            return null;\r\n        }\r\n\r\n        if (channel.target.path !== AnimationChannelTargetPath.POINTER) {\r\n            Logger.Warn(`${context}/target/path: Value (${channel.target.path}) must be (${AnimationChannelTargetPath.POINTER}) when using the ${this.name} extension`);\r\n        }\r\n\r\n        if (channel.target.node != undefined) {\r\n            Logger.Warn(`${context}/target/node: Value (${channel.target.node}) must not be present when using the ${this.name} extension`);\r\n        }\r\n\r\n        const extensionContext = `${context}/extensions/${this.name}`;\r\n\r\n        const pointer = extension.pointer;\r\n        if (!pointer) {\r\n            throw new Error(`${extensionContext}: Pointer is missing`);\r\n        }\r\n\r\n        try {\r\n            const obj = this._pathToObjectConverter.convert(pointer);\r\n            if (!obj.info.interpolation) {\r\n                throw new Error(`${extensionContext}/pointer: Interpolation is missing`);\r\n            }\r\n            return this._loader._loadAnimationChannelFromTargetInfoAsync(\r\n                context,\r\n                animationContext,\r\n                animation,\r\n                channel,\r\n                {\r\n                    object: obj.object,\r\n                    info: obj.info.interpolation,\r\n                },\r\n                onLoad\r\n            );\r\n        } catch (e) {\r\n            Logger.Warn(`${extensionContext}/pointer: Invalid pointer (${pointer}) skipped`);\r\n            return null;\r\n        }\r\n    }\r\n}\r\n\r\nunregisterGLTFExtension(NAME);\r\nregisterGLTFExtension(NAME, true, (loader) => new KHR_animation_pointer(loader));\r\n"],"names":["getVector3","_target","source","offset","scale","FromArray","scaleInPlace","getQuaternion","getWeights","target","value","Array","_numMorphTargets","i","length","AnimationPropertyInfo","type","name","getValue","getStride","_buildAnimation","fps","keys","babylonAnimation","this","setKeys","TransformNodeAnimationPropertyInfo","buildAnimations","babylonAnimations","push","babylonAnimatable","_babylonTransformNode","WeightAnimationPropertyInfo","targetIndex","map","key","frame","inTangent","undefined","outTangent","interpolation","_primitiveBabylonMeshes","babylonMesh","morphTargetManager","morphTarget","getTarget","babylonAnimationClone","clone","animations","ANIMATIONTYPE_VECTOR3","ANIMATIONTYPE_QUATERNION","ANIMATIONTYPE_FLOAT","getColor3","getFloat","getMinusFloat","getNextFloat","getFloatBy2","getTextureTransformTree","textureName","MaterialAnimationPropertyInfo","rotation","CameraAnimationPropertyInfo","_babylonCamera","fillMode","_data","babylonMaterial","LightAnimationPropertyInfo","_babylonLight","MeshAnimationPropertyInfo","mesh","ANIMATIONTYPE_COLOR3","baseColorTextureInterpolation","metallicRoughnessTextureInterpolation","normalTextureInterpolation","occlusionTextureInterpolation","emissiveTextureInterpolation","anisotropyTextureInterpolation","clearcoatTextureInterpolation","clearcoatNormalTextureInterpolation","clearcoatRoughnessTextureInterpolation","iridescenceTextureInterpolation","iridescenceThicknessTextureInterpolation","sheenTextureInterpolation","sheenRoughnessTextureInterpolation","specularTextureInterpolation","specularColorTextureInterpolation","transmissionTextureInterpolation","thicknessTextureInterpolation","diffuseTransmissionTextureInterpolation","diffuseTransmissionColorTextureInterpolation","NAME","KHR_animation_pointer","constructor","loader","_loader","_pathToObjectConverter","gltf","enabled","isExtensionUsed","dispose","_loadAnimationChannelAsync","context","animationContext","animation","channel","onLoad","extension","extensions","path","Warn","node","extensionContext","pointer","Error","obj","convert","info","_loadAnimationChannelFromTargetInfoAsync","object","e"],"ignoreList":[],"sourceRoot":""}